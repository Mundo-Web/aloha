import{j as e}from"./AboutHeader-CpM0iYLI.js";import{r as s}from"./index-B80Lgev0.js";import{c as p}from"./ReactAppend-CBRQCQGz.js";import{r as o}from"./server.browser-D3N0_gce.js";import{C as x}from"./CreateReactScript-CL6ujVDa.js";import{B as u}from"./Base-CNDiEzgL.js";import{D as m,S as f,T as d}from"./SendingHistoryRest-CF4xQaiv.js";import{R as l}from"./ReactAppend-C-tNgxIf.js";import{T as h}from"./Table-DlRAQ7C9.js";import"./index-DO3Aws4m.js";import"./index.esm-Cu-mVv1q.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./main-B2CtU6ez.js";/* empty css               *//* empty css              */import"./tippy-react.esm-CHhA99mn.js";import"./Logout-CPQZ59pt.js";import"./WhatsAppModal-CjZ0YwJN.js";import"./sweetalert2.all-Dh0rZL5X.js";import"./Results-DSLuSBy_.js";const c=new f,j=()=>{const i=s.useRef();s.useRef(),s.useRef(),s.useRef(),s.useRef(),s.useRef(),s.useState(!1);const r=async t=>{await c.reSend(t)&&$(i.current).dxDataGrid("instance").refresh()};return e.jsx(e.Fragment,{children:e.jsx(h,{gridRef:i,title:e.jsx("h4",{className:"header-title my-0",children:"Historial de envios"}),rest:c,toolBar:t=>{t.unshift(m({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(i.current).dxDataGrid("instance").refresh()})),t.unshift(m({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>onOpenModal()}))},pageSize:25,columns:[{dataField:"created_at",dataType:"datetime",caption:"Fecha",width:"180px",sortOrder:"desc",cellTemplate:(t,{data:a})=>{var n;t.text(moment((n=a.created_at)==null?void 0:n.replace("Z","+00:00")).format("lll"))}},{dataField:"type",caption:"Tipo",width:"120px",cellTemplate:(t,{value:a})=>{a=="WhatsApp"?l(t,e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-whatsapp me-1"}),a]})):l(t,e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-email me-1"}),a]}))}},{dataField:"name",caption:"Plantilla"},{dataField:"completed",caption:"Completados",dataType:"number",width:"80px",cellTemplate:(t,{value:a})=>{t.html(o(e.jsx("b",{className:"text-success",children:a})))}},{dataField:"failed",caption:"Fallidos",dataType:"number",width:"80px",cellTemplate:(t,{value:a})=>{t.html(o(e.jsx("b",{className:"text-danger",children:a})))}},{dataField:"total",caption:"Total",dataType:"number",width:"80px",cellTemplate:(t,{value:a})=>{t.html(o(e.jsx("b",{className:"text-primary",children:a})))}},{dataField:"status",caption:"Estado",dataType:"boolean",width:"140px",cellTemplate:(t,{data:a})=>{if(a.status===1&&l(t,e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-check me-1"}),e.jsx("span",{children:"Terminado"})]})),a.status===0&&l(t,e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-alert me-1"}),e.jsx("span",{children:"Fallido"})]})),a.status===null){const n=(a.completed+a.failed)/a.total*100;l(t,e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-spin mdi-autorenew me-1"}),e.jsx("span",{className:"me-1",children:"En curso"}),e.jsxs("small",{className:"text-muted",children:[n.toFixed(2),"%"]})]}))}},lookup:{dataSource:[{key:1,value:"Completado"},{key:0,value:"Enviando"},{key:null,value:"Pendiente"}],valueExpr:"key",displayExpr:"value"}},{caption:"Acciones",width:"130px",cellTemplate:(t,{data:a})=>{t.attr("style","display: flex; gap: 4px; overflow: unset"),a.status===null&&l(t,e.jsx(d,{className:"btn btn-xs btn-soft-primary",title:"Reintentar envio",onClick:()=>r(a.id),children:e.jsx("i",{className:"mdi mdi-reload"})})),a.status!==null&&l(t,e.jsx(d,{className:"btn btn-xs btn-soft-dark",title:"Ver detalles de envio",onClick:()=>console.log("hola"),children:e.jsx("i",{className:"mdi mdi-format-list-bulleted-type"})}))},allowFiltering:!1,allowExporting:!1}]})})};x((i,r)=>{p(i).render(e.jsx(u,{...r,title:"Historial de envios",children:e.jsx(j,{...r})}))});
