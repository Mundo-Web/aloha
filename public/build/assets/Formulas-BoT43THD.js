var F=Object.defineProperty;var w=(t,i,s)=>i in t?F(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;var x=(t,i,s)=>(w(t,typeof i!="symbol"?i+"":i,s),s);import{j as r}from"./AboutHeader-DEdD30eg.js";import{r as o}from"./index-RYns6xqu.js";import{c as S}from"./ReactAppend-vpV7VTGG.js";import{B as E,i as I}from"./Base-DXXGQT4E.js";import{C as y}from"./CreateReactScript-CXQforvT.js";import{T as B}from"./Table-Bi4FivVB.js";import{M as _}from"./Modal-DV4omerP.js";import{I as R}from"./InputFormGroup-Q4dtQxWB.js";import{R as O}from"./ReactAppend-DPXaoPQG.js";import{D}from"./DxButton-CsjWvhyj.js";import{B as G}from"./BasicRest-Dts8qu_l.js";import{S as T}from"./SelectFormGroup-DQ56H9li.js";import{S as k,a as q}from"./SetSelectValue-DnZa52ZJ.js";import"./index-CXU7o9CY.js";/* empty css              */import"./main-BjVPLcVK.js";import"./___vite-browser-external_commonjs-proxy-DbMF7jdq.js";import"./index.esm-Bla6j_hB.js";import"./WhatsAppModal-CqtV5vQS.js";import"./sweetalert2.all-DJo0UVK6.js";/* empty css               */import"./server.browser-D0dT10Bs.js";class A extends G{constructor(){super(...arguments);x(this,"path","admin/formulas")}}const h=new A,C=({})=>{const t=o.useRef(),i=o.useRef(),s=o.useRef(),a=o.useRef(),l=o.useRef(),p=o.useRef(),c=o.useRef(),[m,d]=o.useState(!1),b=e=>{e!=null&&e.id?d(!0):d(!1),s.current.value=(e==null?void 0:e.id)??"",a.current.value=(e==null?void 0:e.name)??"",l.current.value=(e==null?void 0:e.description)??"",p.current.value=(e==null?void 0:e.presentation_order)??0,q(c.current,e==null?void 0:e.supplies,"id","name"),$(i.current).modal("show")},g=async e=>{e.preventDefault();const n={id:s.current.value||void 0,name:a.current.value,description:l.current.value,presentation_order:p.current.value,supplies:$(c.current).val()};await h.save(n)&&($(t.current).dxDataGrid("instance").refresh(),$(i.current).modal("hide"))},f=[{id:"has_treatment",name:"Recibió tratamiento"},{id:"scalp_type",name:"Tipo de cuero cabelludo"},{id:"hair_type",name:"Tipo de cabello"},{id:"hair_thickness",name:"Grosor de cabello"},{id:"hair_goals",name:"Objetivos"}];return r.jsxs(r.Fragment,{children:[r.jsx(B,{gridRef:t,title:"Fórmulas",rest:h,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Step",width:"150px",lookup:{dataSource:f,valueExpr:"id",displayExpr:"name"},sortOrder:"asc",sortIndex:0},{dataField:"description",caption:"Respuesta",width:"200px"},{dataField:"presentation_order",caption:"Orden",width:"75px",sortOrder:"asc",sortIndex:1},{dataField:"supplies.name",caption:"Ingredientes",allowFiltering:!1,cellTemplate:(e,{data:n})=>{O(e,r.jsx("div",{className:"d-flex gap-1",children:n.supplies.map((u,j)=>r.jsx(I,{content:u.name,children:r.jsx("img",{src:`/api/supplies/media/${u.image}`,style:{width:"40px",backgroundColor:"#fff",border:"1px solid rgba(0,0,0,.125)",aspectRatio:5/4,objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:v=>v.target.src="/assets/img/supplies/acido-salicilico.png"},j)}))}))}},{caption:"Acciones",width:"60px",cellTemplate:(e,{data:n})=>{e.css("text-overflow","unset"),e.append(D({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>b(n)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsx(_,{modalRef:i,title:m?"Editar fórmula":"Agregar fórmula",onSubmit:g,size:"md",children:r.jsxs("div",{id:"principal-container",children:[r.jsx("input",{ref:s,type:"hidden"}),r.jsx(T,{eRef:a,label:"Step",required:!0,dropdownParent:"#principal-container",col:"col-12",disabled:m,children:f.map((e,n)=>r.jsx("option",{value:e.id,children:e.name},n))}),r.jsx(R,{eRef:l,label:"Respuesta",required:!0}),r.jsx(R,{eRef:p,label:"Orden de presentacón",type:"number",required:!0}),r.jsx(k,{eRef:c,label:"Ingredientes",searchAPI:"/api/admin/supplies/paginate",searchBy:"name",required:!0,dropdownParent:"#principal-container",col:"col-12",multiple:!0})]})})]})};y((t,i)=>{S(t).render(r.jsx(E,{...i,title:"Fórmulas",children:r.jsx(C,{...i})}))});
