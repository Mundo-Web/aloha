var F=Object.defineProperty;var T=(t,a,s)=>a in t?F(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var w=(t,a,s)=>(T(t,typeof a!="symbol"?a+"":a,s),s);import{j as e}from"./StatisticCard-Bdo2C3ON.js";import{r as o}from"./index-DFv2mRv-.js";import{c as C}from"./ReactAppend-z4_qtB7b.js";import{T as A,D as E}from"./DxButton-BxjpL7bl.js";import{m as R}from"./main-BBbUrZUL.js";import{C as D,G as I}from"./CreateReactScript-yWJ4gJYl.js";import{B}from"./Base-jmuW-WOD.js";import{J as G}from"./JSEncrypt-D3I3x59l.js";import{B as P}from"./BusinessIWorkCard-DtiuTMAn.js";import{r as q}from"./DxBox-DW2A4T63.js";import{R as v}from"./ReactAppend-M1J8-UWR.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./index.esm-B502ZfUP.js";/* empty css               *//* empty css              */import"./tippy-react.esm-3ehftxB_.js";const O=({modalRef:t,title:a="Modal",isStatic:s=!1,size:u="md",children:c,bodyClass:i="",btnCancelText:r,btnSubmitText:m,hideFooter:d,hideButtonSubmit:p,onSubmit:x=h=>{h.preventDefault(),$(t.current).modal("hide")}})=>{const h=s?{"data-bs-backdrop":"static"}:{};return e.jsx("form",{className:"modal fade",ref:t,tabIndex:"-1","aria-hidden":"true",...h,onSubmit:x,autoComplete:"off",children:e.jsx("div",{className:`modal-dialog modal-dialog-centered modal-${u??"md"}`,children:e.jsxs("div",{className:"modal-content ",style:{boxShadow:"0 0 10px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:a}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:`modal-body ${i??""}`,children:c}),!d&&e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-sm btn-danger pull-left",type:"button","data-bs-dismiss":"modal",children:r??"Cerrar"}),!p&&e.jsx("button",{className:"btn btn-sm btn-success pull-right",type:"submit",children:m??"Aceptar"})]})]})})})},y=({col:t,label:a,eRef:s,type:u="text",placeholder:c,required:i=!1,disabled:r=!1,value:m,step:d,onChange:p=()=>{}})=>e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",children:[a," ",i&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("input",{ref:s,type:u,className:"form-control",placeholder:c,required:i,disabled:r,defaultValue:m??"",step:d,onChange:p})]}),J=({col:t,label:a,eRef:s,required:u=!1,dropdownParent:c,searchAPI:i,searchBy:r,multiple:m=!1,filter:d=null,onChange:p=()=>{},templateResult:x,templateSelection:h})=>(s||(s=o.useRef()),o.useEffect(()=>{$(s.current).select2({dropdownParent:c,minimumInputLength:0,ajax:{url:i,headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(R.Cookies.get("XSRF-TOKEN"))},type:"POST",quietMillis:50,data:function({term:f,page:b}){return R.JSON.stringify({sort:[{selector:r,desc:!1}],skip:((b??1)-1)*10,take:10,filter:d?[[r,"contains",f||""],"and",d]:[r,"contains",f||""]})},processResults:function(f,{page:b}){return{results:((f==null?void 0:f.data)??[]).map(g=>{const l=R.JSON.flatten(g);return{id:g.id,text:l[r],data:g}}),pagination:{more:(b??1)*10<f.totalCount}}}},templateResult:x,templateSelection:h})},[c,d]),o.useEffect(()=>{$(s.current).on("change",p)},[d]),e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",children:[a," ",u&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("select",{ref:s,required:u,className:"form-control",style:{width:"100%"},multiple:m})]})),S=({col:t,label:a,eRef:s,placeholder:u,required:c=!1,value:i})=>{s||(s=o.useRef());const[r,m]=o.useState("password"),d=()=>{r=="text"?m("password"):m("text")};return e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",children:[a," ",c&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"input-group input-group-merge",children:[e.jsx("input",{ref:s,type:r,className:"form-control",placeholder:u,required:c,defaultValue:i??""}),e.jsx("div",{className:"input-group-text","data-password":"true",onClick:d,children:e.jsx("i",{className:r=="text"?"mdi mdi-eye-off-outline":"mdi mdi-eye-outline"})})]})]})};class M extends P{constructor(){super(...arguments);w(this,"path","admin/coaches")}}const V=(t,a=!0)=>$("<div>").css({display:"flex",gap:"8px",alignItems:"flex-center",justifyContent:"flex-start"}).dxBox({direction:"row",items:t.filter(Boolean).map(s=>({ratio:0,baseSize:"auto",template:function(u,c,i){if(a)if(o.isValidElement(s)){const r=document.createElement("div");C(r).render(s),i.append(r)}else{const r=document.createElement("div");r.style.width=s.width,r.style.height=s.height,C(r).render(s.children),i.append(r)}else i.append(q(s))}}))}),j=new M,K=({})=>{const t=o.useRef(),a=o.useRef(),s=o.useRef(),u=o.useRef(),c=o.useRef(),i=o.useRef(),r=o.useRef(),m=o.useRef(),d=o.useRef(),p=new G;p.setPublicKey(I.PUBLIC_RSA_KEY);const[x,h]=o.useState(!1),f=async l=>{l.preventDefault();const n=m.current.value,N=d.current.value,k={id:s.current.value||void 0,name:u.current.value,lastname:c.current.value,email:i.current.value,roles:$(r.current).val(),password:n?p.encrypt(n):void 0,confirm:N?p.encrypt(N):void 0};await j.save(k)&&($(t.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},b=async({id:l,status:n})=>{await j.status({id:l,status:n})&&$(t.current).dxDataGrid("instance").refresh()},g=async l=>{await j.delete(l)&&$(t.current).dxDataGrid("instance").refresh()};return e.jsxs(e.Fragment,{children:[e.jsx(A,{gridRef:t,title:"Coaches",rest:j,toolBar:l=>{l.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Nombres"},{dataField:"lastname",caption:"Apellidos"},{dataField:"email",caption:"Correo",dataType:"email",cellTemplate:(l,{data:n})=>{l.append(V([e.jsx("img",{className:"avatar-xs rounded-circle",src:`/api/profile/thumbnail/${n.uuid}`,alt:n.name}),e.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:n.email})],!1))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(l,{data:n})=>{switch(n.status){case 1:v(l,e.jsx("span",{className:"badge bg-success rounded-pill",children:"Activo"}));break;case 0:v(l,e.jsx("span",{className:"badge bg-danger rounded-pill",children:"Inactivo"}));break;default:v(l,e.jsx("span",{className:"badge bg-dark rounded-pill",children:"Eliminado"}));break}}},{caption:"Acciones",cellTemplate:(l,{data:n})=>{l.append(E({className:"btn btn-xs btn-light",title:n.status===null?"Restaurar":"Cambiar estado",icon:n.status===1?"fa fa-toggle-on text-success":n.status===0?"fa fa-toggle-off text-danger":"fas fa-trash-restore",onClick:()=>b(n)})),l.append(E({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>g(n.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(O,{modalRef:a,title:x?"Editar usuario":"Agregar usuario",onSubmit:f,children:e.jsxs("div",{className:"row",id:"users-crud-container",children:[e.jsx("input",{ref:s,type:"hidden"}),e.jsx(y,{eRef:u,label:"Nombres",col:"col-md-6",required:!0}),e.jsx(y,{eRef:c,label:"Apellidos",col:"col-md-6",required:!0}),e.jsx(y,{eRef:i,label:"Correo",col:"col-12",type:"email",required:!0}),e.jsx(J,{eRef:r,label:"Asignar roles",col:"col-12",dropdownParent:"#users-crud-container",searchAPI:"/api/roles/paginate",searchBy:"name",required:!0,multiple:!0}),e.jsx(S,{eRef:m,label:"Contraseña",col:"col-md-6",required:!x}),e.jsx(S,{eRef:d,label:"Repetir contraseña",col:"col-md-6",required:!x})]})})]})};D((t,a)=>{C(t).render(e.jsx(B,{...a,title:"Coaches",children:e.jsx(K,{...a})}))});
