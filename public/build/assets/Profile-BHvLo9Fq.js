var P=Object.defineProperty;var T=(s,a,r)=>a in s?P(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r;var y=(s,a,r)=>(T(s,typeof a!="symbol"?a+"":a,r),r);import{R as e,r as c}from"./Footer-B80Lgev0.js";import{c as k}from"./ReactAppend-BbdAvxK7.js";import{A as O}from"./Adminto-BGAXhy00.js";import{C as U}from"./CreateReactScript-QlbMmlWm.js";import{I as p}from"./InputFormGroup-CZpmvUlF.js";import{i as C}from"./WhatsAppStatuses-BF-FjpQX.js";import"./TippyButton-TBKQ4cvW.js";import{m as d}from"./NavBar-BThilt_4.js";import{S as q}from"./SelectFormGroup-qoOLdQsk.js";import{T as I}from"./TextareaFormGroup-CH1nUIqS.js";import{Q as D}from"./QuillFormGroup-CKFL5hYu.js";import"./MenuItem-COCTGmIB.js";import"./___vite-browser-external_commonjs-proxy-BiUUwCOo.js";class N{}y(N,"save",async a=>{try{const{status:r,result:o}=await d.Fetch("/api/profile",{method:"PATCH",body:JSON.stringify(a)});if(!r)throw new Error((o==null?void 0:o.message)||"Ocurrio un error inesperado");return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:o.message,type:"success"}),!0}catch(r){return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}}),y(N,"saveProfile",async(a,r=!0)=>{try{const{full:o,thumbnail:v,type:b,ok:f}=await File.compress(a,{square:r});if(!f)throw new Error("Ocurrio un error al comprimir la imagen. Intenta con otra.");const m=new FormData;m.append("thumbnail",await File.fromURL(`data:${b};base64,${v}`)),m.append("full",await File.fromURL(`data:${b};base64,${o}`));const n=await fetch("/api/profile",{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(d.Cookies.get("XSRF-TOKEN"))},body:m}),E=JSON.parseable(await n.text());if(!n.ok)throw new Error((E==null?void 0:E.message)??"Ocurrio un error inesperado");return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:"La imagen de perfil se actualizo correctamente",type:"success"}),E.data}catch(o){return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:o.message,type:"danger"}),!1}});class L{constructor(){y(this,"saveCover",async a=>{try{const{full:r,thumbnail:o,type:v,ok:b}=await File.compress(a);if(!b)throw new Error("Ocurrio un error al comprimir la portada. Intenta con otra.");const f=new FormData;f.append("thumbnail",await File.fromURL(`data:${v};base64,${o}`)),f.append("full",await File.fromURL(`data:${v};base64,${r}`));const m=await fetch("/api/cover",{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(d.Cookies.get("XSRF-TOKEN"))},body:f}),n=JSON.parseable(await m.text());if(!m.ok)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:"La imagen de portada se actualizo correctamente",type:"success"}),n.data}catch(r){return d.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}})}}const X=new L,j=s=>{const{countries:a}=s,r=c.useRef(),o=c.useRef(),v=c.useRef(),b=c.useRef(),f=c.useRef(),m=c.useRef(),n=c.useRef(),E=c.useRef(),h=c.useRef(),w=c.useRef(),x=c.useRef(),[t,R]=c.useState(s.session),F=async u=>{u.preventDefault();const l={name:r.current.value,lastname:o.current.value,dni:v.current.value,phone:b.current.value,video:f.current.value,title:m.current.value,country:n.current.value,city:E.current.value,address:h.current.value,summary:w.current.value,description:x.current.value};if(!await N.save(l))return;const i=structuredClone(t);i.name=l.name,i.lastname=l.lastname,i.birthdate=l.birthdate,R(i)},$=async u=>{const l=u.target.files[0];if(!l)return;const g=await N.saveProfile(l,!1);if(!g)return;const i=structuredClone(t);i.uuid=g.uuid,R(i)},S=async u=>{const l=u.target.files[0];if(!l)return;const g=await X.saveCover(l);if(!g)return;const i=structuredClone(t);i.uuid=g.uuid,R(i)};return e.createElement(e.Fragment,null,e.createElement("div",{className:"row justify-content-center align-items-center",style:{minHeight:"calc(100vh - 135px)"}},e.createElement("div",{className:"col-xl-8 col-lg-9 col-md-10 col-sm-11 col-xs-12"},e.createElement("form",{className:"card",onSubmit:F},e.createElement("div",{className:"card-header"},e.createElement("h4",{className:"card-title mb-0"},"Perfil")),e.createElement("div",{className:"card-body"},e.createElement("div",{className:"row"},e.createElement("div",{className:"col-sm-4 col-xs-12 position-relative"},e.createElement(C,{content:"Cambiar portada",arrow:!0},e.createElement("label",{htmlFor:"cover",className:"ratio ratio-21x9",style:{cursor:"pointer"}},e.createElement("input",{className:"d-none",type:"file",name:"cover",id:"cover",accept:"image/*",onChange:S}),e.createElement("img",{src:`/api/cover/${t.uuid}?v=${crypto.randomUUID()}`,alt:`Perfil de ${t.name} ${t.lastname}`,style:{width:"100%",objectFit:"cover",objectPosition:"center",borderRadius:"4px"}}))),e.createElement(C,{content:"Cambiar foto de perfil",arrow:!0},e.createElement("label",{htmlFor:"avatar",className:"rounded-circle mx-auto d-block position-relative",style:{cursor:"pointer",width:"max-content",marginTop:"-48px"}},e.createElement("input",{className:"d-none",type:"file",name:"avatar",id:"avatar",accept:"image/*",onChange:$}),e.createElement("img",{className:"avatar-xl rounded-circle bg-white",src:`/api/profile/${t.uuid}?v=${crypto.randomUUID()}`,alt:`Perfil de ${t.name} ${t.lastname}`,style:{objectFit:"cover",objectPosition:"center"}}))),e.createElement("ul",{className:"social-list list-inline mt-3 mb-0"},e.createElement("li",{className:"list-inline-item"},e.createElement("a",{href:"#",className:"social-list-item border-purple text-purple"},e.createElement("i",{className:"fab fa-facebook-f"}))),e.createElement("li",{className:"list-inline-item"},e.createElement("a",{href:"#",className:"social-list-item border-danger text-danger"},e.createElement("i",{className:"mdi mdi-google"}))),e.createElement("li",{className:"list-inline-item"},e.createElement("a",{href:"#",className:"social-list-item border-info text-info"},e.createElement("i",{className:"mdi mdi-twitter"}))),e.createElement("li",{className:"list-inline-item"},e.createElement("a",{href:"#",className:"social-list-item border-secondary text-secondary"},e.createElement("i",{className:"mdi mdi-github"}))))),e.createElement("div",{className:"col-sm-8 col-xs-12"},e.createElement("div",{className:"row"},e.createElement(p,{eRef:r,label:"Nombres",value:t.name,required:!0,col:"col-md-6 col-sm-12"}),e.createElement(p,{eRef:o,label:"Apellidos",value:t.lastname,required:!0,col:"col-md-6 col-sm-12"}),e.createElement(p,{eRef:v,label:"DNI",value:t.dni,required:!0,col:"col-md-6 col-sm-12"}),e.createElement(p,{eRef:b,label:"Telefono",value:t.phone,col:"col-md-6 col-sm-12"}),e.createElement(p,{eRef:f,label:"Video de YouTube",value:`https://youtu.be/${t.video}`}),e.createElement(p,{eRef:m,label:"Titulo",value:t.title,col:"col-md-6 col-sm-12",required:!0}),e.createElement(q,{eRef:n,label:"Pais",value:t.country,col:"col-md-6 col-sm-12",required:!0},a.map((u,l)=>e.createElement("option",{key:`country-${l}`,value:u.id,selected:u.id==t.country},u.name))),e.createElement(p,{eRef:E,label:"Ciudad",value:t.city,col:"col-md-6 col-sm-12",required:!0}),e.createElement(p,{eRef:h,label:"Direccion",value:t.address,col:"col-md-6 col-sm-12"}),e.createElement(I,{eRef:w,label:"Resumen",col:"col-12",value:t.summary}),e.createElement(D,{eRef:x,label:"Descripcion",col:"col-12",value:t.description,height:"240px",required:!0})),e.createElement("div",{className:"text-center"},e.createElement("button",{className:"btn btn-primary btn-block",type:"submit"},e.createElement("i",{className:"fa fa-save"})," Actualizar")),e.createElement("hr",{className:"mt-3 mb-2"}),e.createElement("p",{className:"card-text text-center"},e.createElement("small",{className:"text-muted"},"Ultima actualizacion ",moment(t.updated_at).fromNow())))))))))};U((s,a)=>{k(s).render(e.createElement(O,{...a,title:"Perfil de usuario"},e.createElement(j,{...a})))});
