var U=Object.defineProperty;var K=(d,m,j)=>m in d?U(d,m,{enumerable:!0,configurable:!0,writable:!0,value:j}):d[m]=j;var $=(d,m,j)=>(K(d,typeof m!="symbol"?m+"":m,j),j);import{j as e}from"./AboutHeader-CpM0iYLI.js";import{r as C}from"./index-B80Lgev0.js";import{c as Y}from"./ReactAppend-CBRQCQGz.js";import{B as W}from"./Base-Daq0Lhuj.js";import{G as z,C as X}from"./CreateReactScript-CL6ujVDa.js";import{m as k}from"./main-B2CtU6ez.js";import{i as L}from"./tippy-react.esm-CHhA99mn.js";import{A as V}from"./CallToAction-Y9yYs4wC.js";import{N as A}from"./Number2Currency-e57Tgsuk.js";import{N as Z}from"./NewFormulaButton-i0Ux9JQQ.js";import{U as ee}from"./UserFormulasRest-CUuZlsfm.js";import{S as T}from"./sweetalert2.all-Dh0rZL5X.js";import{C as te}from"./CouponsRest-CF_zR6Xf.js";import{c as O}from"./createLucideIcon-Cx5eUsrb.js";import"./index-DO3Aws4m.js";import"./Base-ku_qAI12.js";import"./index-B1nVdsa0.js";import"./index-CqrOtH36.js";import"./index.esm-Cu-mVv1q.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";/* empty css               *//* empty css              */import"./BasicRest-Dr9i-95X.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=O("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=O("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=O("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);class M{}$(M,"order",async(m,j)=>{try{const{status:y,result:f}=await k.Fetch("/api/culqi/order",{method:"POST",body:k.JSON.stringify({sale:m,details:j})});if(!y)throw new Error((f==null?void 0:f.message)||"Ocurrio un error inesperado");return k.Notify.add({icon:"/assets/img/favicon.png",title:"Correcto",body:f.message,type:"success"}),f}catch(y){return k.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:y.message,type:"danger"}),null}}),$(M,"token",async m=>{try{const{status:j,result:y}=await k.Fetch("/api/culqi/token",{method:"POST",body:k.JSON.stringify(m)});if(!j)throw new Error((y==null?void 0:y.message)||"Ocurrio un error inesperado");return k.Notify.add({icon:"/assets/img/favicon.png",title:"Correcto",body:y.message,type:"success"}),y}catch(j){return k.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:j.message,type:"danger"}),null}});const le=({formula:d,otherFormulas:m,goToNextPage:j,goToPrevPage:y,items:f=[],setSelectedPlan:E})=>{const[_,r]=C.useState((k.Local.get("vua_cart")??[]).filter(g=>!!g.formula_id));C.useEffect(()=>{r(g=>g.map(a=>{var p;const c=((p=f.find(S=>S.id==a.id))==null?void 0:p.colors)??[],x=a.colors??[],n=a.quantity,i=n-x.length,N=new Array(i>0?i:0).fill((c==null?void 0:c[0])??null);return x.length<n?a.colors=[...x,...N].filter(Boolean):a.colors=x.slice(0,n).filter(Boolean),a}))},[null]);const v=(g,a,c,x)=>{const n=x??(d==null?void 0:d.id);r(i=>i.map(N=>(N.id==g&&N.formula_id==n&&(N.colors[a]=c),N)))},w=()=>{m.length>0?(E(null),j(2)):j()};return C.useEffect(()=>{k.Local.set("vua_cart",_)},[_]),C.useEffect(()=>{V.init()},[null]),e.jsxs("section",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center text-[#404040]",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Ahora selecciona el color!"}),e.jsxs("p",{className:"mb-8 text-sm font-extralight",children:[e.jsx("span",{children:"Elije tus colores favoritos para tu rutina"}),e.jsx("img",{className:"w-4 inline-block ms-2",src:"/assets/img/emojis/stars.png",alt:"Elije tus colores favoritos para tu rutina"})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-5 mt-5 sm:mt-8 lg:mt-10",children:_.sort((g,a)=>{const c=m.find(n=>n.id==g.formula_id)??d,x=m.find(n=>n.id==a.formula_id)??d;return c.created_at<x.created_at?-1:1}).map((g,a)=>{var i,N;const c=m.findIndex(p=>p.id==g.formula_id)+1,x=m.find(p=>p.id==g.formula_id)??d,n=((i=f.find(p=>p.id==g.id))==null?void 0:i.colors)??[];return n.length==0?null:(N=g.colors)==null?void 0:N.map((p,S)=>e.jsx("div",{className:"overflow-hidden w-full md:w-[calc(50%-10px)] lg:w-[calc(33.333%-13.33px)] bg-white rounded-2xl shadow-md","data-aos":"fade-down",children:e.jsxs("div",{className:"flex flex-row gap-2 items-center p-2",children:[e.jsx("div",{className:"",children:e.jsx("img",{className:"h-[120px] aspect-[3/4] object-cover object-center rounded-md",src:`/api/colors/media/${p==null?void 0:p.image}`,alt:g.name})}),e.jsx("div",{className:"",children:e.jsx("div",{className:"flex flex-wrap gap-3 items-end self-stretch my-auto ",children:e.jsxs("div",{className:"flex flex-col items-start self-stretch",children:[e.jsxs("small",{className:"block mb-1 font-bold",children:[e.jsx("i",{className:"mdi mdi-flask me-1"}),c==0?"Fórmula principal":e.jsxs(e.Fragment,{children:[c+1,e.jsx("sup",{children:"a"})," fórmula"]})]}),e.jsxs("h2",{className:"text-lg font-semibold tracking-normal leading-none text-neutral-700 mb-2",children:[g.name," ",S+1]}),e.jsx("p",{className:" text-sm font-light tracking-normal leading-none text-neutral-700 mb-2",children:"Selecciona tu color:"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:n.map((s,h)=>{const o=(p==null?void 0:p.id)==s.id;return e.jsx(L,{content:s.name,children:e.jsx("button",{className:`flex shrink-0 w-8 aspect-square rounded-full border ${o?"shadow-md border-[#000000]":""}`,style:{backgroundColor:s.hex||"#fff"},onClick:()=>v(g.id,S,s,x.id)})},h)})})]})})})]})},`existence-${a}-${S}`))}).filter(Boolean)}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:[e.jsxs("button",{onClick:()=>y(),className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsxs("button",{onClick:w,className:"bg-[#C5B8D4] text-white text-sm px-14 py-3 rounded mt-4",children:["SIGUIENTE",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]})]})]})},ne=({otherFormulas:d,goToNextPage:m,goToPrevPage:j,setSelectedPlan:y,bundles:f=[],planes:E=[],session:_})=>{const r=k.Local.get("vua_cart")??[],v=r.reduce((n,i)=>n+i.price*i.quantity,0),w=r.reduce((n,i)=>n+i.quantity,0),g=f.filter(n=>{switch(n.comparator){case"<":return w<n.items_quantity;case">":return w>n.items_quantity;default:return w==n.items_quantity}}).sort((n,i)=>i.percentage-n.percentage),a=(g==null?void 0:g[0])??null,c=Math.round(v*(1-((a==null?void 0:a.percentage)||0))*10)/10,x=n=>{y(n),m()};return C.useEffect(()=>{d.length>0&&x(null)},[null]),e.jsxs("section",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Elije la frecuencia de tu pedido!"}),e.jsx("p",{className:"mb-8 text-sm font-extralight",children:"Conoce de qué manera puedes ahorrar en tu rutina"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4 mt-5 sm:mt-8 lg:mt-10 items-center justify-center",children:[e.jsxs("div",{className:"transition-all cursor-pointer p-6 bg-white group hover:bg-[#EFBEC1] hover:text-white rounded-2xl grid grid-cols-2 items-center justify-between gap-4 shadow-md h-full",onClick:()=>x(null),children:[e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"block font-extralight",children:"Comprar por"}),e.jsx("span",{className:"block font-bold mb-2 -mt-1 text-[#303030]",children:"1 sola vez"})]}),e.jsx("div",{className:"flex flex-col gap-2 text-end",children:e.jsxs("span",{className:"ms-auto text-4xl text-[#C0AFD4] group-hover:text-white font-extrabold tracking-tighter",children:["S/",A(c)]})})]}),d.length==0&&e.jsx(e.Fragment,{children:!(_!=null&&_.id)&&E.length>0?e.jsxs("div",{className:"p-4 text-center flex flex-col gap-2 items-center",children:[e.jsxs("span",{children:["o inicia sesion para acceder a ",e.jsx("br",{}),e.jsx("b",{children:"planes de suscripcion"})]}),e.jsx("button",{href:"/login",className:"block rounded-full px-3 py-2 bg-[#A191B8] text-white text-sm uppercase",children:"Iniciar sesion"})]}):E.sort((n,i)=>i.percentage-n.percentage).map((n,i)=>{const N=Math.round((c-c*n.percentage)*10)/10;return e.jsxs("div",{className:"cursor-pointer p-6 bg-white transition-all rounded-2xl grid grid-cols-2 items-center justify-between gap-4 shadow-md h-full hover:bg-[#EFBEC1] hover:text-white peer-checked:bg-[#EFBEC1] peer-checked:text-white group",onClick:()=>x(n.id),children:[e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"block",children:"Suscripción"}),e.jsxs("span",{className:"block font-bold mb-2 -mt-1",children:["Cada ",n.name]}),e.jsx("div",{className:"border border-[#404040] text-xs px-2 py-1 rounded-full w-max  group-hover:border-white peer-checked:border-white ",children:"+ Envío gratis Lima Met."})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-end",children:[e.jsxs("span",{className:"ms-auto text-nowrap text-xs px-2 py-1 rounded-full w-max text-white bg-[#C0AFD4] group-hover:text-[#EEA9D2] group-hover:bg-white peer-checked:text-[#EEA9D2] peer-checked:bg-white ",children:["-",n.percentage*100,"%OFF",e.jsx("img",{className:"w-3 inline-block ms-1",src:"/assets/img/emojis/fire.png",alt:"-{plan.percentage * 100}%OFF"})]}),e.jsxs("span",{className:"ms-auto text-4xl text-[#C0AFD4] font-bold group-checked:text-white group-hover:text-white",children:["S/",A(N)]})]})]},i)})})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:e.jsxs("button",{onClick:()=>j(),className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]})})]})},ie=new ee,ce=({formula:d,otherFormulas:m,setOtherFormulas:j,goToNextPage:y,items:f=[],bundles:E=[]})=>{const _=k.Local.get("vua_cart")??f.map(s=>{if(s.is_default)return s.quantity=1,s.formula_id=d.id,s}).filter(Boolean),[r,v]=C.useState(_.filter(s=>!!f.find(h=>s.id==h.id))??[]),w=r.reduce((s,h)=>s+h.price*h.quantity,0),g=(s,h,o)=>{const b=o??d.id,u=s.target.checked;v(u?F=>[...F,{...h,quantity:1,formula_id:b}]:F=>F.filter(B=>!(B.id==h.id&&B.formula_id==b)))},a=r.reduce((s,h)=>s+h.quantity,0),c=E.filter(s=>{switch(s.comparator){case"<":return a<s.items_quantity;case">":return a>s.items_quantity;default:return a==s.items_quantity}}).sort((s,h)=>h.percentage-s.percentage),x=(c==null?void 0:c[0])??null,n=Math.round(w*(1-((x==null?void 0:x.percentage)||0))*10)/10,i=(s,h)=>{const o=h??d.id;r.find(b=>b.id==s.id&&b.formula_id==o)?v(b=>b.map(u=>(u.id==s.id&&u.formula_id==o&&u.quantity++,u))):(document.getElementById(`item-${s.id}`).checked=!0,v(b=>[...b,{...s,quantity:1,formula_id:o}]))},N=(s,h)=>{const o=h??d.id;v(b=>b.map(u=>(u.id==s.id&&u.formula_id==o&&u.quantity--,u.quantity<=0?document.getElementById(`item-${s.id}`).checked=!1:u)).filter(Boolean))},p=async s=>{const{isConfirmed:h}=await T.fire({title:"¿Estás seguro?",text:"¿Estás seguro de eliminar esta fórmula?",showCancelButton:!0,confirmButtonColor:"#71b6f9",cancelButtonColor:"#d94d4d",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!h||!await ie.delete(s)||(j(b=>b.filter(u=>u.id!=s)),v(b=>b.filter(u=>u.formula_id!=s)))},S=async()=>{const s=r.some(o=>o.formula_id===d.id),h=m.every(o=>r.some(b=>b.formula_id===o.id));if(!s||!h){await T.fire({title:"¡Hay una fórmula vacía!",text:"Selecciona al menos un producto por fórmula.",confirmButtonColor:"#71b6f9",confirmButtonText:"Entendido"});return}y()};return C.useEffect(()=>{k.Local.set("vua_cart",r)},[r]),C.useEffect(()=>{V.init()},[null]),e.jsxs("form",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center text-[#404040]",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Selecciona tus productos personalizados!"}),e.jsxs("p",{className:"mb-8 text-sm font-extralight",children:[e.jsx("span",{children:"Para mejores resultados arma una rutina completa"}),e.jsx("img",{className:"w-4 inline-block ms-2",src:"/assets/img/emojis/stars.png",alt:"Para mejores resultados arma una rutina completa"})]})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"block w-1/2 mx-auto mb-4"}),e.jsxs("h2",{className:"text-xl mb-6",children:["Productos para tu ",e.jsx("b",{children:"fórmula principal"})]})]}),e.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:f.map((s,h)=>{const o=r.find(u=>u.id==s.id&&u.formula_id==d.id),b=(o==null?void 0:o.quantity)??0;return e.jsxs("div",{className:"flex flex-col w-[180px] whitespace-nowrap","data-aos":"fade-up",children:[e.jsx("input",{type:"checkbox",name:"",id:`item-${s.id}`,className:"peer hidden",onChange:u=>g(u,s),checked:!!o,required:!0}),e.jsxs("label",{htmlFor:`item-${s.id}`,className:"flex overflow-hidden flex-col tracking-normal leading-none text-center bg-white rounded-xl border peer-checked:border-[#808080] peer-checked:shadow-md text-[#404040] cursor-pointer mb-3 transition-all",children:[e.jsx("img",{loading:"lazy",src:`/api/items/media/${s.image}`,className:"object-cover object-center aspect-[3/4] w-full border-b",alt:"Shampoo product image",onError:u=>u.target.src="/assets/img/routine/conditioner.png"}),e.jsx("h2",{className:"self-center px-4 py-3",children:s.name})]}),e.jsxs("div",{className:"flex gap-5 justify-between items-center self-center py-1 text-sm bg-transparent rounded-lg border border-[#808080] w-[70%] px-4 font-bold",children:[e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>N(s),disabled:b<=0,children:"-"}),e.jsx("span",{children:b}),e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>i(s),children:"+"})]})]},h)})})}),m.length>0&&m.map((s,h)=>e.jsxs("div",{className:"max-w-4xl mx-auto mb-8",children:[e.jsxs("h2",{className:"text-xl mb-6",children:["Productos para tu ",e.jsxs("b",{children:[h+2,e.jsx("sup",{children:"a"})," fórmula"]}),e.jsx(L,{content:"Eliminar esta fórmula",children:e.jsx("i",{className:"mdi mdi-trash-can-outline text-red-400 font-bold ms-2 cursor-pointer",onClick:()=>p(s.id)})})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:f.map((o,b)=>{const u=r.find(B=>B.id==o.id&&B.formula_id==s.id),F=(u==null?void 0:u.quantity)??0;return e.jsxs("div",{className:"flex flex-col w-[180px] whitespace-nowrap","data-aos":"fade-up",children:[e.jsx("input",{type:"checkbox",name:"",id:`item-${o.id}-${s.id}`,className:"peer hidden",onChange:B=>g(B,o,s.id),checked:!!u,required:!0}),e.jsxs("label",{htmlFor:`item-${o.id}-${s.id}`,className:"flex overflow-hidden flex-col tracking-normal leading-none text-center bg-white rounded-xl border peer-checked:border-[#808080] peer-checked:shadow-md text-[#404040] cursor-pointer mb-3 transition-all",children:[e.jsx("img",{loading:"lazy",src:`/api/items/media/${o.image}`,className:"object-cover object-center aspect-[3/4] w-full border-b",alt:"Shampoo product image",onError:B=>B.target.src="/assets/img/routine/conditioner.png"}),e.jsx("h2",{className:"self-center px-4 py-3",children:o.name})]}),e.jsxs("div",{className:"flex gap-5 justify-between items-center self-center py-1 text-sm bg-transparent rounded-lg border border-[#808080] w-[70%] px-4 font-bold",children:[e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>N(o,s.id),disabled:F<=0,children:"-"}),e.jsx("span",{children:F}),e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>i(o,s.id),children:"+"})]})]},b)})})]},h)),(m==null?void 0:m.length)<3&&e.jsx(Z,{formula:d,roundedFull:!0,showIcon:!0}),e.jsxs("div",{className:"max-w-2xl mx-auto mt-5 sm:mt-8 lg:mt-10 px-[3%]",children:[e.jsxs("p",{className:"text-md",children:["Agrega más de un producto y ",e.jsx("b",{children:"obtén nuestros descuentos"})," por packs."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center bg-[#EFBEC1] text-white rounded-3xl mt-4 py-4 px-[5%] font-extrabold shadow-lg",children:[e.jsxs("div",{className:"text-xl text-start",children:["Elegiste ",x?x.name:e.jsxs(e.Fragment,{children:[a," ",a==1?"producto":"productos"]}),x&&e.jsx("span",{className:"block text-xs font-light",children:x.description})]}),e.jsxs("div",{className:"flex flex-row text-white items-center gap-4",children:[w!=n&&e.jsxs("p",{className:"font-light line-through",children:["Antes: S/",A(w)]}),e.jsxs("h2",{className:"text-2xl",children:["S/",A(n)]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:[e.jsxs("a",{href:`/test/result/${d.id}`,className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsxs("button",{onClick:S,className:"bg-[#C5B8D4] text-white text-sm px-14 py-3 tracking-widest rounded mt-4 disabled:cursor-not-allowed leadin",disabled:a==0,children:["SIGUIENTE",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]})]})]})},P={metropolitana:{name:"Lima Metropolitana",delivery:"Gratis",items:["Ate","Barranco","Breña","Cercado de Lima","Chorrillos","Comas","El Agustino","Independencia","Jesús María","La Molina","La Victoria","Lince","Los Olivos","Magdalena del Mar","Miraflores","Pueblo Libre","Rímac","San Borja","San Isidro","San Juan de Lurigancho","San Juan de Miraflores","San Luis","San Martin de Porres","San Miguel","Santa Anita","Santiago de Surco","Surquillo","Villa el Salvador","Villa Maria del Triunfo"]},alrededores:{name:"Lima Alrededores",delivery:"Por Shalom - Pago en destino",items:["Ancón","Carabayllo","Chaclacayo","Cieneguilla","Lurín","Pachacámac","Pucusana","Puente Piedra","Punta Hermosa","Punta Negra","San Bartolo","Lurigancho (Chosica)","Santa María del Mar","Santa Rosa"]},provincias:{name:"Provincias",delivery:"Por Shalom - Pago en destino",items:""}},de=new te,oe=({formula:d,otherFormulas:m,goToPrevPage:j,publicKey:y,selectedPlan:f,bundles:E,planes:_,session:r})=>{var R;const v=C.useRef(null);Culqi.publicKey=y??"",Culqi.options({paymentMethods:{tarjeta:!0,yape:!f,billetera:!f,bancaMovil:!f,agente:!f,cuotealo:!1},installments:!f,style:{logo:`${location.origin}/assets/img/icon-purple.svg`,bannerColor:"#A191B8"}});const w=k.Local.get("vua_cart"),g=Object.keys(P).find(t=>P[t].name==(r==null?void 0:r.department)),[a,c]=C.useState({name:(r==null?void 0:r.name)||null,lastname:(r==null?void 0:r.lastname)||null,email:d.email,phone:(r==null?void 0:r.phone)||null,country:"Perú",department:g?g||"provincias":null,province:(r==null?void 0:r.province)||(r==null?void 0:r.department)||null,district:(r==null?void 0:r.district)||null,zip_code:(r==null?void 0:r.zip_code)||null,address:(r==null?void 0:r.address)||null,number:(r==null?void 0:r.address_number)||null,reference:(r==null?void 0:r.address_reference)||null,comment:null,billing_type:"boleta",billing_number:""}),[x,n]=C.useState(!1),[i,N]=C.useState(null),p=w.reduce((t,l)=>t+l.price*l.quantity,0),S=w.reduce((t,l)=>t+l.quantity,0),s=E.filter(t=>{switch(t.comparator){case"<":return S<t.items_quantity;case">":return S>t.items_quantity;default:return S==t.items_quantity}}).sort((t,l)=>l.percentage-t.percentage),h=(s==null?void 0:s[0])??null,o=p*((h==null?void 0:h.percentage)||0),b=_.find(t=>t.id==f),u=(p-o)*((b==null?void 0:b.percentage)||0),F=(p-o-u)*((i==null?void 0:i.amount)||0)/100,B=()=>{let t="Lima",l="Lima",q=null;return Array.isArray(P[a.department].items)?(t=P[a.department].name,l=a.province,q=null):(t=a.province,l=null,q=a.district),{...a,department:t,province:l,district:q}},H=async t=>{if(t.preventDefault(),x)return;n(!0);let l=null;if(p>6){const q=await M.order({...B(),order_number:Culqi.order_number,user_formula_id:d.id,renewal_id:f,coupon:(i==null?void 0:i.name)??null},w);q&&(l=q.data.id,Culqi.order_number=q.data.order_number)}n(!1),Culqi.settings({title:`${z.APP_NAME} ${f?"(Suscripción)":""}`.trim(),currency:"PEN",amount:Math.round(Math.ceil((p-o-u-F)*100)/10)*10,order:l}),Culqi.open()};window.culqi=async()=>{if(Culqi.token)await M.token({order:Culqi.order_number,token:Culqi.token})&&(location.href="/thanks");else if(Culqi.order){Q();const t=Culqi.order_number.replace(`#${z.APP_CORRELATIVE}-`,"");fetch(`/api/sales/notify/${t}`)}};const Q=()=>{setInterval(()=>{Culqi.isOpen||(location.href="/thanks")},500)},I=t=>{t.preventDefault();const l=(v.current.value||"").trim().toUpperCase();l&&de.save({coupon:l,amount:p,email:d.email}).then(q=>{N(q?q.data:null)})},G=t=>{t.key=="Enter"&&I(t)};return e.jsx(e.Fragment,{children:e.jsx("section",{className:"px-[5%] md:px-[7.5%] lg:px-[10%] pb-[5%] mt-[7.5%] md:mt-[5%] lg:mt-[2.5%] text-[#404040]",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex justify-center space-x-8 text-sm text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"SSL Pago Seguro"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"24/7 Atención al cliente"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Pago online"})]})]}),e.jsx("form",{className:"w-full rounded-lg bg-white p-8 shadow-lg",onSubmit:H,disabled:x,children:e.jsxs("div",{className:"grid gap-8 md:grid-cols-2 lg:grid-cols-5 relative",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("button",{onClick:()=>j(m.length>0?2:1),className:"bg-[#C5B8D4] text-white text-sm px-4 py-2 rounded mb-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Información del cliente"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"email",children:["Dirección de correo electrónico ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"email",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.email,placeholder:"Dirección de correo electrónico",onChange:t=>c(l=>({...l,email:t.target.value})),required:!0,disabled:!0})]}),e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Detalles de facturación"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"firstName",children:["Nombre ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"firstName",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.name,onChange:t=>c(l=>({...l,name:t.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"lastName",children:["Apellidos ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"lastName",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.lastname,onChange:t=>c(l=>({...l,lastname:t.target.value})),required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"country",children:["País / Región ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"country",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.country,disabled:!0,required:!0})]}),e.jsx("div",{className:"mt-4 grid gap-4 md:grid-cols-5",children:e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"department",children:["Región / Provincia ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"department",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.department||"",onChange:t=>c(l=>({...l,department:t.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),Object.keys(P).map((t,l)=>e.jsx("option",{value:t,children:P[t].name},l))]})]})}),P[a.department]&&e.jsx("div",{className:"mt-4 grid gap-4 md:grid-cols-5",children:Array.isArray(P[a.department].items)?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"district",children:["Provincia ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"province",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.province,onChange:t=>c(l=>({...l,province:t.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),P[a.department].items.map((t,l)=>e.jsx("option",{value:t,children:t},l))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:"Código postal"}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.zip_code,onChange:t=>c(l=>({...l,zip_code:t.target.value}))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:["Departamento ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.province??(r==null?void 0:r.department),onChange:t=>c(l=>({...l,province:t.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:["Distrito ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.district,onChange:t=>c(l=>({...l,district:t.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:"Código postal"}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.zip_code,onChange:t=>c(l=>({...l,zip_code:t.target.value}))})]})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-5 lg:grid-cols-3",children:[e.jsxs("div",{className:"md:col-span-3 lg:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"address",children:["Dirección de la calle ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"address",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.address,placeholder:"Nombre de la calle y número de la calle",onChange:t=>c(l=>({...l,address:t.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"number",children:["Número ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"number",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.number,placeholder:"Nombre de la calle y número de la calle",onChange:t=>c(l=>({...l,number:t.target.value})),required:!0})]})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"apartment",children:"Apartamento, habitación, piso, etc. (opcional)"}),e.jsx("input",{type:"text",id:"apartment",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.reference,onChange:t=>c(l=>({...l,reference:t.target.value}))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"phone",children:["Teléfono/Celular ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex border rounded-md border-gray-300",children:[e.jsx("span",{className:"py-2 px-3 border-e",children:"+51"}),e.jsx("input",{type:"tel",id:"phone",className:"w-full p-2 text-sm outline-none",value:a.phone,onChange:t=>c(l=>({...l,phone:t.target.value})),placeholder:"900000000",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"orderNotes",children:"Notas del pedido (opcional)"}),e.jsx("textarea",{id:"orderNotes",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",rows:3,placeholder:"Notas sobre tu pedido, por ejemplo, notas especiales para la entrega.",value:a.comment||"",onChange:t=>c(l=>({...l,comment:t.target.value})),style:{minHeight:81,fieldSizing:"content"}})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"mb-4 text-xl font-semibold",children:"Pago"}),e.jsxs("div",{className:"rounded-md border border-gray-300",children:[e.jsxs("div",{className:"p-4 py-3 flex justify-between",children:[e.jsx("img",{className:"h-4",src:"/assets/img/checkout/culqi-logo.svg",alt:"Culqi"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{className:"h-4",src:"/assets/img/checkout/cards.svg",alt:"Cards"}),e.jsx("img",{className:"h-4",src:"/assets/img/checkout/pagoefectivo.svg",alt:"Pago efectivo"}),e.jsx("img",{className:"h-4",src:"/assets/img/checkout/yape.svg",alt:"Yape"})]})]}),e.jsxs("p",{className:"text-xs bg-[#f9f9f9] p-4 px-6 rounded-b",children:["Acepta pagos con ",e.jsx("b",{children:"tarjetas de débito y crédito, Yape, Cuotealo BCP y PagoEfectivo"}),"(billeteras móviles, agentes y bodegas)."]})]})]}),e.jsx("div",{className:"mt-6 text-xs",children:e.jsxs("p",{className:"text-justify",children:["Sus datos personales se utilizarán para procesar su pedido, respaldar su experiencia en este sitio web y para otros fines descritos en nuestra "," ",e.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"política de privacidad"}),"."]})})]}),e.jsxs("div",{className:"lg:col-span-2 relative",children:[e.jsxs("div",{className:"block mb-6",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tu pedido"}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 flex justify-between border-b pb-2 font-bold",children:[e.jsx("span",{className:"",children:"Producto"}),e.jsx("span",{className:"",children:"Subtotal"})]}),e.jsx("div",{className:"mb-2",children:w.map((t,l)=>{var q;return e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 aspect-[3/4] relative",children:e.jsx("img",{className:"h-10 aspect-[3/4] object-contain object-center rounded-md border",src:`/api/colors/media/${(q=t.colors[0])==null?void 0:q.image}`,alt:t.name,onError:D=>D.target.src=`/api/items/media/${t.image}`})}),e.jsxs("div",{children:[e.jsx("p",{children:t.name}),e.jsxs("small",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"w-6 inline-block text-nowrap",children:["× ",t.quantity]}),e.jsx("div",{className:"inline-flex flex-wrap gap-1",children:t.colors.map((D,J)=>e.jsx("i",{className:"mdi mdi-circle",style:{color:(D==null?void 0:D.hex)??"#000",WebkitTextStroke:"1px #808080"}},J))})]})]})]}),e.jsxs("span",{className:"",children:["S/ ",A(t.price*t.quantity)]})]},l)})}),e.jsxs("div",{className:"mb-2 mt-4 flex justify-between border-b pb-2 text-sm font-bold",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["S/ ",A(Math.round(p*10)/10)]})]}),h&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Descuento x paquete",e.jsxs("small",{className:"block text-xs font-light",children:["Elegiste ",h.name," (-",Math.round(h.percentage*1e4)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",A(Math.round(o*10)/10)]})]}),b&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Subscripción",e.jsxs("small",{className:"block text-xs font-light",children:[b.name," (-",Math.round(b.percentage*1e4)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",A(Math.round(u*10)/10)]})]}),i&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado ",e.jsx(L,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>N(null)})}),e.jsxs("small",{className:"block text-xs font-light",children:[i.name," ",e.jsx(L,{content:i.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," (-",Math.round(i.amount*100)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",A(F)]})]}),a.department&&e.jsxs("div",{className:"mb-4 flex justify-between text-sm border-b pb-2",children:[e.jsx("span",{className:"font-bold",children:"Envío"}),e.jsx("span",{children:(R=P==null?void 0:P[a.department])==null?void 0:R.delivery})]}),e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",A(Math.round((p-o-u-F)*10)/10)]})]})]}),!i&&e.jsxs("div",{className:"mt-6 flex",children:[e.jsx("input",{ref:v,type:"text",placeholder:"Código de cupón",className:"w-full rounded-l-md border border-gray-300 p-2 px-4 text-sm outline-none uppercase focus:border-[#C5B8D4]",value:i==null?void 0:i.name,onKeyDown:G,disabled:x}),e.jsx("button",{className:"rounded-r-md bg-[#C5B8D4] px-4 py-2 text-sm text-white",type:"button",onClick:I,disabled:x,children:"Aplicar"})]})]}),e.jsxs("div",{className:"block sticky top-4",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Datos de facturacion"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"mb-1 block text-sm font-medium ",htmlFor:"billing_type",children:["Tipo de comprobante ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"billing_type",value:"boleta",id:"billing_type_boleta",defaultChecked:a.billing_type=="boleta",className:"hidden peer",onChange:t=>c(l=>({...l,billing_type:t.target.value})),checked:a.billing_type=="boleta",required:!0}),e.jsxs("label",{htmlFor:"billing_type_boleta",className:"flex gap-1.5 items-center justify-center px-2 py-1 border rounded-md cursor-pointer peer-checked:bg-[#C5B8D4] peer-checked:text-white transition-colors",children:[e.jsx("i",{className:"mdi mdi-account text-lg"}),e.jsx("span",{children:"Boleta"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"billing_type",value:"factura",id:"billing_type_factura",defaultChecked:a.billing_type=="factura",className:"hidden peer",onChange:t=>c(l=>({...l,billing_type:t.target.value})),checked:a.billing_type=="factura",required:!0}),e.jsxs("label",{htmlFor:"billing_type_factura",className:"flex gap-1.5 items-center justify-center px-2 py-1 border rounded-md cursor-pointer peer-checked:bg-[#C5B8D4] peer-checked:text-white transition-colors",children:[e.jsx("i",{className:"mdi mdi-office-building text-lg"}),e.jsx("span",{children:"Factura"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1 block text-sm font-medium ",htmlFor:"billing_number",children:["Documento ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"billing_number",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.billing_number,maxLength:a.billing_type=="boleta"?8:11,minLength:a.billing_type=="boleta"?8:11,required:!0,onChange:t=>c(l=>({...l,billing_number:t.target.value}))})]}),e.jsxs("button",{type:"submit",className:"mt-6 w-full rounded-md bg-[#C5B8D4] py-3 text-white disabled:cursor-not-allowed",disabled:x,children:[e.jsx("i",{className:"mdi mdi-lock me-1"}),"Pagar Ahora",e.jsxs("small",{className:"ms-1",children:["(S/ ",A(p-o-u-F),")"]})]})]})]})]})})]})})})},me=({user_formula:d,other_formulas:m,items:j,publicKey:y,session:f,bundles:E,planes:_})=>{const[r,v]=C.useState(0),[w,g]=C.useState(null),[a,c]=C.useState(m.sort((p,S)=>p.created_at<S.created_at?1:-1)),x=(p=1)=>{r<i.length-1&&v(r+p)},n=(p=1)=>{r>0&&v(r-p)},i=[{name:"Select Product",component:e.jsx(ce,{formula:d,otherFormulas:a,setOtherFormulas:c,items:j,goToNextPage:x,bundles:E})},{name:"Select Color",component:e.jsx(le,{formula:d,otherFormulas:a,items:j,goToNextPage:x,goToPrevPage:n,setSelectedPlan:g})},{name:"Select Plan",component:e.jsx(ne,{formula:d,otherFormulas:a,goToNextPage:x,goToPrevPage:n,setSelectedPlan:g,session:f,bundles:E,planes:_})},{name:"Checkout",component:e.jsx(oe,{formula:d,otherFormulas:a,goToPrevPage:n,publicKey:y,selectedPlan:w,goToNextPage:x,bundles:E,planes:_,session:f})}],N=i[r].component;return C.useEffect(()=>{k.Local.set("vua_formula",d)},[null]),N};X((d,m)=>{Y(d).render(e.jsx(W,{...m,children:e.jsx(me,{...m})}))});
