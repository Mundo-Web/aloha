var re=Object.defineProperty;var ie=(r,t,i)=>t in r?re(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var P=(r,t,i)=>(ie(r,typeof t!="symbol"?t+"":t,i),i);import{j as o}from"./AboutHeader-CpM0iYLI.js";import{r as g}from"./index-B80Lgev0.js";import{c as oe}from"./ReactAppend-CBRQCQGz.js";import{C as ae}from"./CreateReactScript-BTmFJSrT.js";import{R}from"./ReactAppend-C-tNgxIf.js";import{M as F}from"./Modal-Dbgjpj-3.js";import{I as se}from"./InputFormGroup-d90I7Tt8.js";import{T as le}from"./TextareaFormGroup-BkvHoRll.js";import{i as ce}from"./tippy-react.esm-CHhA99mn.js";/* empty css              */import{S as ue}from"./sweetalert2.all-Dh0rZL5X.js";import{S as de}from"./SelectFormGroup-iHLz_kPb.js";import{p as n}from"./index-CqrOtH36.js";import{B as fe}from"./Results-DSLuSBy_.js";import{B as pe}from"./Base-v3ghxxF6.js";import{r as Y}from"./server.browser-D3N0_gce.js";import{m as me}from"./main-B2CtU6ez.js";import{S as he}from"./SwitchFormGroup-Cv62QkRk.js";import"./index-DO3Aws4m.js";import"./index.esm-Cu-mVv1q.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";/* empty css               */import"./Logout-CPQZ59pt.js";import"./WhatsAppModal-CjZ0YwJN.js";const I=({title:r,className:t,onClick:i,children:a,eRef:s,...u})=>o.jsx(ce,{content:r,arrow:!0,children:o.jsx("button",{ref:s,className:t,onClick:i,...u,children:a})});var L=function(){return L=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},L.apply(this,arguments)},J={onActivate:n.func,onAddUndo:n.func,onBeforeAddUndo:n.func,onBeforeExecCommand:n.func,onBeforeGetContent:n.func,onBeforeRenderUI:n.func,onBeforeSetContent:n.func,onBeforePaste:n.func,onBlur:n.func,onChange:n.func,onClearUndos:n.func,onClick:n.func,onContextMenu:n.func,onCommentChange:n.func,onCompositionEnd:n.func,onCompositionStart:n.func,onCompositionUpdate:n.func,onCopy:n.func,onCut:n.func,onDblclick:n.func,onDeactivate:n.func,onDirty:n.func,onDrag:n.func,onDragDrop:n.func,onDragEnd:n.func,onDragGesture:n.func,onDragOver:n.func,onDrop:n.func,onExecCommand:n.func,onFocus:n.func,onFocusIn:n.func,onFocusOut:n.func,onGetContent:n.func,onHide:n.func,onInit:n.func,onInput:n.func,onKeyDown:n.func,onKeyPress:n.func,onKeyUp:n.func,onLoadContent:n.func,onMouseDown:n.func,onMouseEnter:n.func,onMouseLeave:n.func,onMouseMove:n.func,onMouseOut:n.func,onMouseOver:n.func,onMouseUp:n.func,onNodeChange:n.func,onObjectResizeStart:n.func,onObjectResized:n.func,onObjectSelected:n.func,onPaste:n.func,onPostProcess:n.func,onPostRender:n.func,onPreProcess:n.func,onProgressState:n.func,onRedo:n.func,onRemove:n.func,onReset:n.func,onSaveContent:n.func,onSelectionChange:n.func,onSetAttrib:n.func,onSetContent:n.func,onShow:n.func,onSubmit:n.func,onUndo:n.func,onVisualAid:n.func,onSkinLoadError:n.func,onThemeLoadError:n.func,onModelLoadError:n.func,onPluginLoadError:n.func,onIconsLoadError:n.func,onLanguageLoadError:n.func,onScriptsLoad:n.func,onScriptsLoadError:n.func},ve=L({apiKey:n.string,licenseKey:n.string,id:n.string,inline:n.bool,init:n.object,initialValue:n.string,onEditorChange:n.func,value:n.string,tagName:n.string,tabIndex:n.number,cloudChannel:n.string,plugins:n.oneOfType([n.string,n.array]),toolbar:n.oneOfType([n.string,n.array]),disabled:n.bool,textareaName:n.string,tinymceScriptSrc:n.oneOfType([n.string,n.arrayOf(n.string),n.arrayOf(n.shape({src:n.string,async:n.bool,defer:n.bool}))]),rollback:n.oneOfType([n.number,n.oneOf([!1])]),scriptLoading:n.shape({async:n.bool,defer:n.bool,delay:n.number})},J),B=function(r){return typeof r=="function"},V=function(r){return r in J},U=function(r){return r.substr(2)},ge=function(r,t,i,a,s,u,e){var l=Object.keys(s).filter(V),d=Object.keys(u).filter(V),m=l.filter(function(h){return u[h]===void 0}),v=d.filter(function(h){return s[h]===void 0});m.forEach(function(h){var p=U(h),x=e[p];i(p,x),delete e[p]}),v.forEach(function(h){var p=a(r,h),x=U(h);e[x]=p,t(x,p)})},ye=function(r,t,i,a,s){return ge(s,r.on.bind(r),r.off.bind(r),function(u,e){return function(l){var d;return(d=u(e))===null||d===void 0?void 0:d(l,r)}},t,i,a)},H=0,Q=function(r){var t=Date.now(),i=Math.floor(Math.random()*1e9);return H++,r+"_"+i+H+String(t)},G=function(r){return r!==null&&(r.tagName.toLowerCase()==="textarea"||r.tagName.toLowerCase()==="input")},K=function(r){return typeof r>"u"||r===""?[]:Array.isArray(r)?r:r.split(" ")},be=function(r,t){return K(r).concat(K(t))},xe=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},we=function(r){if(!("isConnected"in Node.prototype)){for(var t=r,i=r.parentNode;i!=null;)t=i,i=t.parentNode;return t===r.ownerDocument}return r.isConnected},q=function(r,t){r!==void 0&&(r.mode!=null&&typeof r.mode=="object"&&typeof r.mode.set=="function"?r.mode.set(t):r.setMode(t))},M=function(){return M=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},M.apply(this,arguments)},Ce=function(r,t,i){var a,s,u=r.createElement("script");u.referrerPolicy="origin",u.type="application/javascript",u.id=t.id,u.src=t.src,u.async=(a=t.async)!==null&&a!==void 0?a:!1,u.defer=(s=t.defer)!==null&&s!==void 0?s:!1;var e=function(){u.removeEventListener("load",e),u.removeEventListener("error",l),i(t.src)},l=function(d){u.removeEventListener("load",e),u.removeEventListener("error",l),i(t.src,d)};u.addEventListener("load",e),u.addEventListener("error",l),r.head&&r.head.appendChild(u)},je=function(r){var t={},i=function(e,l){var d=t[e];d.done=!0,d.error=l;for(var m=0,v=d.handlers;m<v.length;m++){var h=v[m];h(e,l)}d.handlers=[]},a=function(e,l,d){var m=function(E){return d!==void 0?d(E):console.error(E)};if(e.length===0){m(new Error("At least one script must be provided"));return}for(var v=0,h=!1,p=function(E,k){h||(k?(h=!0,m(k)):++v===e.length&&l())},x=0,b=e;x<b.length;x++){var y=b[x],C=t[y.src];if(C)C.done?p(y.src,C.error):C.handlers.push(p);else{var j=Q("tiny-");t[y.src]={id:j,src:y.src,done:!1,error:null,handlers:[p]},Ce(r,M({id:j},y),i)}}},s=function(){for(var e,l=0,d=Object.values(t);l<d.length;l++){var m=d[l],v=r.getElementById(m.id);v!=null&&v.tagName==="SCRIPT"&&((e=v.parentNode)===null||e===void 0||e.removeChild(v))}t={}},u=function(){return r};return{loadScripts:a,deleteScripts:s,getDocument:u}},Ee=function(){var r=[],t=function(s){var u=r.find(function(e){return e.getDocument()===s});return u===void 0&&(u=je(s),r.push(u)),u},i=function(s,u,e,l,d){var m=function(){return t(s).loadScripts(u,l,d)};e>0?setTimeout(m,e):m()},a=function(){for(var s=r.pop();s!=null;s=r.pop())s.deleteScripts()};return{loadList:i,reinitialize:a}},Se=Ee(),O=function(r){var t=r;return t&&t.tinymce?t.tinymce:null},ke=function(){var r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(a[u]=s[u])},r(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");r(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),_=function(){return _=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},_.apply(this,arguments)},_e=function(r){ke(t,r);function t(i){var a,s,u,e=r.call(this,i)||this;return e.rollbackTimer=void 0,e.valueCursor=void 0,e.rollbackChange=function(){var l=e.editor,d=e.props.value;l&&d&&d!==e.currentContent&&l.undoManager.ignore(function(){if(l.setContent(d),e.valueCursor&&(!e.inline||l.hasFocus()))try{l.selection.moveToBookmark(e.valueCursor)}catch{}}),e.rollbackTimer=void 0},e.handleBeforeInput=function(l){if(e.props.value!==void 0&&e.props.value===e.currentContent&&e.editor&&(!e.inline||e.editor.hasFocus()))try{e.valueCursor=e.editor.selection.getBookmark(3)}catch{}},e.handleBeforeInputSpecial=function(l){(l.key==="Enter"||l.key==="Backspace"||l.key==="Delete")&&e.handleBeforeInput(l)},e.handleEditorChange=function(l){var d=e.editor;if(d&&d.initialized){var m=d.getContent();e.props.value!==void 0&&e.props.value!==m&&e.props.rollback!==!1&&(e.rollbackTimer||(e.rollbackTimer=window.setTimeout(e.rollbackChange,typeof e.props.rollback=="number"?e.props.rollback:200))),m!==e.currentContent&&(e.currentContent=m,B(e.props.onEditorChange)&&e.props.onEditorChange(m,d))}},e.handleEditorChangeSpecial=function(l){(l.key==="Backspace"||l.key==="Delete")&&e.handleEditorChange(l)},e.initialise=function(l){var d,m,v;l===void 0&&(l=0);var h=e.elementRef.current;if(h){if(!we(h)){if(l===0)setTimeout(function(){return e.initialise(1)},1);else if(l<100)setTimeout(function(){return e.initialise(l+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var p=O(e.view);if(!p)throw new Error("tinymce should have been loaded into global scope");var x=_(_(_(_({},e.props.init),{selector:void 0,target:h,readonly:e.props.disabled,inline:e.inline,plugins:be((d=e.props.init)===null||d===void 0?void 0:d.plugins,e.props.plugins),toolbar:(m=e.props.toolbar)!==null&&m!==void 0?m:(v=e.props.init)===null||v===void 0?void 0:v.toolbar}),e.props.licenseKey?{license_key:e.props.licenseKey}:{}),{setup:function(b){e.editor=b,e.bindHandlers({}),e.inline&&!G(h)&&b.once("PostRender",function(y){b.setContent(e.getInitialValue(),{no_events:!0})}),e.props.init&&B(e.props.init.setup)&&e.props.init.setup(b)},init_instance_callback:function(b){var y,C,j=e.getInitialValue();e.currentContent=(y=e.currentContent)!==null&&y!==void 0?y:b.getContent(),e.currentContent!==j&&(e.currentContent=j,b.setContent(j),b.undoManager.clear(),b.undoManager.add(),b.setDirty(!1));var E=(C=e.props.disabled)!==null&&C!==void 0?C:!1;q(e.editor,E?"readonly":"design"),e.props.init&&B(e.props.init.init_instance_callback)&&e.props.init.init_instance_callback(b)}});e.inline||(h.style.visibility=""),G(h)&&(h.value=e.getInitialValue()),p.init(x)}},e.id=e.props.id||Q("tiny-react"),e.elementRef=g.createRef(),e.inline=(u=(a=e.props.inline)!==null&&a!==void 0?a:(s=e.props.init)===null||s===void 0?void 0:s.inline)!==null&&u!==void 0?u:!1,e.boundHandlers={},e}return Object.defineProperty(t.prototype,"view",{get:function(){var i,a;return(a=(i=this.elementRef.current)===null||i===void 0?void 0:i.ownerDocument.defaultView)!==null&&a!==void 0?a:window},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(i){var a=this,s,u;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(i),this.editor.initialized)){if(this.currentContent=(s=this.currentContent)!==null&&s!==void 0?s:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==i.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var e=this.editor;e.undoManager.transact(function(){var d;if(!a.inline||e.hasFocus())try{d=e.selection.getBookmark(3)}catch{}var m=a.valueCursor;if(e.setContent(a.props.value),!a.inline||e.hasFocus())for(var v=0,h=[d,m];v<h.length;v++){var p=h[v];if(p)try{e.selection.moveToBookmark(p),a.valueCursor=p;break}catch{}}})}if(this.props.disabled!==i.disabled){var l=(u=this.props.disabled)!==null&&u!==void 0?u:!1;q(this.editor,l?"readonly":"design")}}},t.prototype.componentDidMount=function(){var i=this,a,s,u,e,l;if(O(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(s=(a=this.props).onScriptsLoadError)===null||s===void 0||s.call(a,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((u=this.elementRef.current)===null||u===void 0)&&u.ownerDocument){var d=function(){var v,h;(h=(v=i.props).onScriptsLoad)===null||h===void 0||h.call(v),i.initialise()},m=function(v){var h,p;(p=(h=i.props).onScriptsLoadError)===null||p===void 0||p.call(h,v)};Se.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(l=(e=this.props.scriptLoading)===null||e===void 0?void 0:e.delay)!==null&&l!==void 0?l:0,d,m)}},t.prototype.componentWillUnmount=function(){var i=this,a=this.editor;a&&(a.off(this.changeEvents(),this.handleEditorChange),a.off(this.beforeInputEvent(),this.handleBeforeInput),a.off("keypress",this.handleEditorChangeSpecial),a.off("keydown",this.handleBeforeInputSpecial),a.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(s){a.off(s,i.boundHandlers[s])}),this.boundHandlers={},a.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.changeEvents=function(){var i,a,s,u=(s=(a=(i=O(this.view))===null||i===void 0?void 0:i.Env)===null||a===void 0?void 0:a.browser)===null||s===void 0?void 0:s.isIE();return u?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},t.prototype.beforeInputEvent=function(){return xe()?"beforeinput SelectionChange":"SelectionChange"},t.prototype.renderInline=function(){var i=this.props.tagName,a=i===void 0?"div":i;return g.createElement(a,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.renderIframe=function(){return g.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.getScriptSources=function(){var i,a,s=(i=this.props.scriptLoading)===null||i===void 0?void 0:i.async,u=(a=this.props.scriptLoading)===null||a===void 0?void 0:a.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:s,defer:u}]:this.props.tinymceScriptSrc.map(function(m){return typeof m=="string"?{src:m,async:s,defer:u}:m});var e=this.props.cloudChannel,l=this.props.apiKey?this.props.apiKey:"no-api-key",d="https://cdn.tiny.cloud/1/".concat(l,"/tinymce/").concat(e,"/tinymce.min.js");return[{src:d,async:s,defer:u}]},t.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},t.prototype.bindHandlers=function(i){var a=this;if(this.editor!==void 0){ye(this.editor,i,this.props,this.boundHandlers,function(l){return a.props[l]});var s=function(l){return l.onEditorChange!==void 0||l.value!==void 0},u=s(i),e=s(this.props);!u&&e?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):u&&!e&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},t.propTypes=ve,t.defaultProps={cloudChannel:"7"},t}(g.Component);class Ne extends fe{constructor(){super(...arguments);P(this,"path","admin/mailing/templates")}}const W=({className:r="btn btn-xs btn-default rounded-pill",location:t="after",icon:i,text:a,title:s,onClick:u=()=>{}})=>({widget:"dxButton",location:t,options:{icon:i,text:a,hint:s,onClick:u,template:(e,l)=>{l.parent().attr("style","border: none !important; background: transparent !important"),l.attr("class",r),l.html(Y(o.jsxs(o.Fragment,{children:[e.icon&&o.jsx("i",{className:`${e.icon}`}),o.jsx("span",{className:"d-none d-md-inline-block ms-1",children:e.text})]})))}}}),Re=({col:r,label:t,eRef:i,editorRef:a,placeholder:s,required:u=!1,rows:e=6,value:l="",onChange:d=()=>{}})=>{const[m,v]=g.useState(l),h=g.useRef(),p=a||g.useRef(),x=i||h;return g.useEffect(()=>(p.current&&(p.current.toTextArea(),p.current=null),p.current=CodeMirror.fromTextArea(x.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2,lineNumbers:!0}),p.current.setSize(null,600),p.current.setValue(l),setTimeout(()=>{p.current.refresh()},125),p.current.on("change",b=>{const y=b.getValue();v(y),d({target:{value:y}})}),()=>{p.current&&(p.current.toTextArea(),p.current=null)}),[x]),g.useEffect(()=>{m!==l&&(v(l),p.current&&(p.current.setValue(l),setTimeout(()=>{p.current.refresh()},125)))},[l]),o.jsxs("div",{className:`form-group ${r} mb-2`,children:[t&&o.jsxs("label",{htmlFor:"",className:"mb-1",children:[t," ",u&&o.jsx("b",{className:"text-danger",children:"*"})]}),o.jsx("textarea",{ref:x,className:"form-control",placeholder:s,required:u,rows:e,defaultValue:l,onChange:b=>v(b.target.value)})]})},Te=({gridRef:r,rest:t,columns:i,toolBar:a,masterDetail:s,filterValue:u,onRefresh:e=()=>{}})=>(g.useEffect(()=>{DevExpress.localization.locale(navigator.language),$(r.current).dxDataGrid({language:"es",dataSource:{load:async l=>{const d=await t.paginate({...l});return e(d),d}},onToolbarPreparing:l=>{const{items:d}=l.toolbarOptions;a(d)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!0},searchPanel:{visible:!0},headerFilter:{visible:!0,search:{enabled:!0}},height:"calc(100vh - 185px)",filterValue:u,rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:10},pager:{visible:!0,allowedPageSizes:[5,10,25,50,100],showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!0,mode:"select",search:{enabled:!0}},columns:i,masterDetail:s,onContentReady:(...l)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0})},[null]),o.jsx("div",{ref:r})),De=({title:r,gridRef:t,rest:i,columns:a,toolBar:s,masterDetail:u,filterValue:e=[],onRefresh:l})=>o.jsx("div",{className:"row",children:o.jsx("div",{className:"col-12",children:o.jsxs("div",{className:"card",children:[typeof r=="object"?o.jsx("div",{className:"card-header",children:r}):"",o.jsxs("div",{className:"card-body",children:[typeof r!="object"?o.jsxs("h4",{className:"header-title",children:[o.jsx("div",{id:"header-title-options",className:"float-end"}),o.jsx("span",{id:"header-title-prefix"})," Lista de ",r," ",o.jsx("span",{id:"header-title-suffix"})]}):"",o.jsx(Te,{gridRef:t,rest:i,columns:a.filter(Boolean),toolBar:s,masterDetail:u,filterValue:e,onRefresh:l})]})]})})}),N=new Ne,Ie=({TINYMCE_KEY:r})=>{const t=g.useRef(),i=g.useRef(),a=g.useRef(),s=g.useRef(),u=g.useRef(),e=g.useRef(),l=g.useRef(),d=g.useRef(),m=g.useRef(),v=g.useRef(),[h,p]=g.useState(!1),[x,b]=g.useState({}),[y,C]=g.useState("wysiwyg"),[j,E]=g.useState(""),[k,X]=g.useState(""),[S,T]=g.useState(""),z=c=>{c!=null&&c.id?p(!0):p(!1),e.current.value=(c==null?void 0:c.id)||null,$(l.current).val((c==null?void 0:c.type)||null).trigger("change"),d.current.value=(c==null?void 0:c.name)||null,m.current.value=(c==null?void 0:c.description)||null,$(v.current).val((c==null?void 0:c.model)||null).trigger("change"),$(`[name="auto_send"][value="${(c==null?void 0:c.auto_send)||0}"]`).prop("checked",!0),$(i.current).modal("show")},Z=async c=>{console.log(c);const f=await N.get(c.id);b(f),C("wysiwyg"),E((f==null?void 0:f.content)??"<i>- Agrega tu contenido aqui -</i>"),$(a.current).modal("show")},ee=async c=>{c.preventDefault();const f={id:e.current.value||void 0,name:d.current.value,description:m.current.value,model:v.current.value,auto_send:$('[name="auto_send"]:checked').val()};await N.save(f)&&($(t.current).dxDataGrid("instance").refresh(),$(i.current).modal("hide"))},ne=async c=>{c.preventDefault();const f={id:x.id,content:y=="wysiwyg"?j:y=="code"?k:S};await N.save(f)&&$(a.current).modal("hide")},te=async c=>{const{isConfirmed:f}=await ue.fire({title:"Eliminar registro",text:"¿Está seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"});!f||!await N.delete(c)||$(t.current).dxDataGrid("instance").refresh()},D=c=>{C(f=>(f=="wysiwyg"&&c=="code"?(u.current.setValue(html_beautify(j,{indent_empty_lines:!0,preserve_newlines:!0,max_preserve_newlines:1,indent_size:2})),setTimeout(()=>{u.current.refresh()},125)):f=="wysiwyg"&&c=="dropzone"?T(j):f=="code"&&c=="wysiwyg"?E(k):f=="code"&&c=="dropzone"?T(k):f=="dropzone"&&c=="wysiwyg"?E(S):f=="dropzone"&&c=="code"&&(u.current.setValue(html_beautify(S,{indent_empty_lines:!0,preserve_newlines:!0,max_preserve_newlines:1,indent_size:2})),setTimeout(()=>{u.current.refresh()},125)),c))},A=c=>{c.text().then(f=>{const w=$("<body>").html(f);w.find("style").remove(),w.find("script").remove(),w.find("meta").remove(),w.find("title").remove(),w.find("link").remove(),T(w.html().trim())})};return g.useEffect(()=>{me.Clipboard.paste(s.current,c=>{!c||(c==null?void 0:c.length)==0||!c[0].type.startsWith("text/")||A(c[0])})},[null]),o.jsxs(o.Fragment,{children:[o.jsx(De,{gridRef:t,title:"Plantillas",rest:N,toolBar:c=>{c.unshift(W({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(t.current).dxDataGrid("instance").refresh()})),c.unshift(W({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>z()}))},columns:[{dataField:"name",caption:"Nombre",cellTemplate:(c,{data:f})=>{c.html(Y(o.jsx("b",{children:f.name})))}},{dataField:"description",caption:"Descripcion"},{dataField:"model",caption:"Tabla",cellTemplate:(c,{data:f})=>{c.text(f.model||"Externo")},lookup:{dataSource:[{value:"",text:"Externo"},{value:"User",text:"Usuarios"},{value:"Sale",text:"Ventas"},{value:"Subscription",text:"Subscripciones"}],valueExpr:"value",displayExpr:"text"}},{dataField:"auto_send",caption:"Tipo de envio",dataType:"boolean",cellTemplate:(c,{data:f})=>{c.text(f.auto_send?"Automatico":"Manual")},lookup:{dataSource:[{value:0,text:"Manual"},{value:1,text:"Automatico"}],valueExpr:"value",displayExpr:"text"}},{dataField:"status",caption:"Estado",dataType:"boolean",width:"120px",cellTemplate:(c,{data:f})=>{R(c,o.jsx(he,{checked:f.status,onChange:w=>onVisibleChange({id:f.id,value:w.target.checked})}))}},{caption:"Acciones",width:"150px",cellTemplate:(c,{data:f})=>{c.attr("style","display: flex; gap: 4px; overflow: unset"),R(c,o.jsx(I,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>z(f),children:o.jsx("i",{className:"fa fa-pen"})})),R(c,o.jsx(I,{className:"btn btn-xs btn-soft-dark",title:"Diseñar plantilla",onClick:()=>Z(f),"data-loading-text":'<i className="fa fa-spinner fa-spin"></i>',children:o.jsx("i",{className:"far fa-edit"})})),R(c,o.jsx(I,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>te(f.id),children:o.jsx("i",{className:"fa fa-trash-alt"})}))},allowFiltering:!1,allowExporting:!1}]}),o.jsx(F,{modalRef:i,title:h?"Editar plantilla":"Agregar plantilla",onSubmit:ee,size:"sm",children:o.jsxs("div",{className:"row",id:"template-container",children:[o.jsx("input",{ref:e,type:"hidden"}),o.jsx(se,{eRef:d,label:"Nombre",required:!0}),o.jsx(le,{eRef:m,label:"Descripcion"}),o.jsxs(de,{eRef:v,label:"Origen de datos",dropdownParent:"#template-container",required:!0,children:[o.jsx("option",{value:"",children:"Externo"}),o.jsx("option",{value:"User",children:"Usuarios"}),o.jsx("option",{value:"Sale",children:"Ventas"}),o.jsx("option",{value:"Subscription",children:"Subscripciones"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{className:"form-label",children:"Tipo de envio"}),o.jsxs("div",{className:"row col-12",children:[o.jsx("div",{className:"col-sm-6",children:o.jsxs("div",{class:"form-check",children:[o.jsx("input",{type:"radio",id:"auto_send_false",name:"auto_send",class:"form-check-input",value:0,defaultChecked:!0}),o.jsx("label",{class:"form-check-label",for:"auto_send_false",children:"Manual"})]})}),o.jsx("div",{className:"col-sm-6",children:o.jsxs("div",{class:"form-check",children:[o.jsx("input",{type:"radio",id:"auto_send_true",name:"auto_send",class:"form-check-input",value:1}),o.jsx("label",{class:"form-check-label",for:"auto_send_true",children:"Automatico"})]})})]})]})]})}),o.jsxs(F,{modalRef:a,title:`Diseñador de plantillas - ${x.name}`,btnSubmitText:"Guardar",onSubmit:ne,size:"xl",isStatic:!0,children:[o.jsxs("ul",{className:"nav nav-pills navtab-bg justify-content-center flex-wrap gap-1",children:[o.jsx("li",{className:"nav-item",children:o.jsxs("a",{href:"#wysiwyg-editor",className:`nav-link text-center ${y=="wysiwyg"?"active":""}`,style:{width:"200px"},onClick:()=>D("wysiwyg"),children:[o.jsx("i",{className:"mdi mdi-page-layout-header-footer me-1"}),"Editor WYSIWYG"]})}),o.jsx("li",{className:"nav-item",children:o.jsxs("a",{href:"#code-editor",className:`nav-link text-center ${y=="code"?"active":""}`,style:{width:"200px"},onClick:()=>D("code"),children:[o.jsx("i",{className:"mdi mdi-code-tags me-1"}),"Editor de codigo"]})}),o.jsx("li",{className:"nav-item",children:o.jsxs("a",{href:"#dropzone",className:`nav-link text-center ${y=="dropzone"?"active":""}`,style:{width:"200px"},onClick:()=>D("dropzone"),children:[o.jsx("i",{className:"mdi mdi-cloud-upload me-1"}),"Carga tu archivo"]})})]}),o.jsxs("div",{className:"tab-content",children:[o.jsxs("div",{className:`tab-pane ${y=="wysiwyg"?"active":""}`,id:"wysiwyg-editor",children:[o.jsx(_e,{apiKey:r,init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",tinycomments_mode:"embedded",tinycomments_author:"Author name",mergetags_list:[{value:"First.Name",title:"First Name"},{value:"Email",title:"Email"}],ai_request:(c,f)=>f.string(()=>Promise.reject("See docs to implement AI Assistant")),height:"600px"},value:j,onEditorChange:c=>E(c)}),o.jsx("div",{className:"mb-2"})]}),o.jsx("div",{className:`tab-pane ${y=="code"?"active":""}`,id:"code-editor",children:o.jsx(Re,{editorRef:u,onChange:c=>X(c.target.value)})}),o.jsx("div",{className:`tab-pane ${y=="dropzone"?"active":""}`,id:"dropzone",children:o.jsx("div",{ref:s,className:"d-flex align-items-center justify-content-center mb-2 border",style:{height:"600px",borderRadius:"10px"},children:o.jsxs("div",{children:[o.jsx("input",{className:"d-none",id:"dropzone-file",type:"file",accept:"text/html,text/plain",onChange:c=>{c.preventDefault();const f=[...c.target.files];c.target.value=null,f.length!=0&&A(f[0])}}),o.jsxs("label",{htmlFor:"dropzone-file",className:"d-block mx-auto mb-2 btn btn-sm btn-white rounded-pill waves-effect",style:{width:"max-content"},children:[o.jsx("i",{className:"mdi mdi-paperclip me-1"}),"Seleccionar archivo"]}),o.jsx("label",{htmlFor:"dropzone-file",className:"d-block",style:{cursor:"pointer"},children:"Arrastra y suelta tu plantilla aquí, o haz clic para seleccionar tu archivo HTML."}),(S==null?void 0:S.trim())&&o.jsxs("button",{className:"d-block mx-auto mt-2 btn btn-sm btn-primary rounded-pill waves-effect",onClick:()=>{const c=new Blob([S],{type:"text/html"}),f=window.URL.createObjectURL(c),w=document.createElement("a");w.href=f,w.download="template.html",w.click(),window.URL.revokeObjectURL(f)},type:"button",children:[o.jsx("i",{className:"mdi mdi-download me-1"}),"Descargar HTML"]})]})})})]})]})]})};ae((r,t)=>{oe(r).render(o.jsx(pe,{...t,title:"Plantillas de Email",children:o.jsx(Ie,{...t})}))});
