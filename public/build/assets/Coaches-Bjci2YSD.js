var S=Object.defineProperty;var B=(t,a,s)=>a in t?S(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var v=(t,a,s)=>(B(t,typeof a!="symbol"?a+"":a,s),s);import{j as e}from"./AboutHeader-QvZ8i92b.js";import{r as c}from"./index-uubelm5h.js";import{c as F}from"./ReactAppend-C3qAwPla.js";import{M as D}from"./Modal-BjUpi4c3.js";import"./main-_LuzYDr5.js";import{S as A}from"./SelectAPIFormGroup-C3rjkou7.js";import{C as P,G}from"./CreateReactScript-Bp1rCZww.js";import{B as k}from"./Base-CU5RJThd.js";import{J as T}from"./JSEncrypt-D3I3x59l.js";import{B as I}from"./Results-9uBmKgby.js";import{D as z}from"./DxBox-C7uX_LZA.js";import{R as g}from"./ReactAppend-BImswh4V.js";import"./index-DybDQSmn.js";import"./___vite-browser-external_commonjs-proxy-vlWEfB-S.js";import"./index.esm-Bf_f5uRl.js";/* empty css               *//* empty css              */import"./tippy-react.esm-uoFc-fr3.js";import"./DxBox-DSsR7sSi.js";const M=({gridRef:t,rest:a,columns:s,toolBar:d,masterDetail:n,filterValue:u,onRefresh:l=()=>{}})=>(c.useEffect(()=>{DevExpress.localization.locale(navigator.language),$(t.current).dxDataGrid({language:"es",dataSource:{load:async i=>{const m=await a.paginate({...i});return l(m),m}},onToolbarPreparing:i=>{const{items:m}=i.toolbarOptions;d(m)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!0},searchPanel:{visible:!0},headerFilter:{visible:!0,search:{enabled:!0}},height:"calc(100vh - 185px)",filterValue:u,rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:10},pager:{visible:!0,allowedPageSizes:[5,10,25,50,100],showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!0,mode:"select",search:{enabled:!0}},columns:s,masterDetail:n,onContentReady:(...i)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0})},[null]),e.jsx("div",{ref:t})),q=({title:t,gridRef:a,rest:s,columns:d,toolBar:n,masterDetail:u,filterValue:l=[],onRefresh:i})=>e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[typeof t=="object"?e.jsx("div",{className:"card-header",children:t}):"",e.jsxs("div",{className:"card-body",children:[typeof t!="object"?e.jsxs("h4",{className:"header-title",children:[e.jsx("div",{id:"header-title-options",className:"float-end"}),e.jsx("span",{id:"header-title-prefix"})," Lista de ",t," ",e.jsx("span",{id:"header-title-suffix"})]}):"",e.jsx(M,{gridRef:a,rest:s,columns:d.filter(Boolean),toolBar:n,masterDetail:u,filterValue:l,onRefresh:i})]})]})})}),j=({col:t,label:a,eRef:s,type:d="text",placeholder:n,required:u=!1,disabled:l=!1,readOnly:i=!1,value:m,min:p,max:f,step:R,onChange:h=()=>{}})=>e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[a," ",u&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("input",{ref:s,type:d,className:"form-control",placeholder:n,required:u,disabled:l,readOnly:i,defaultValue:m??"",step:R,onChange:h,min:p,max:f})]}),w=({col:t,label:a,eRef:s,placeholder:d,required:n=!1,value:u})=>{s||(s=c.useRef());const[l,i]=c.useState("password"),m=()=>{l=="text"?i("password"):i("text")};return e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[a," ",n&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"input-group input-group-merge",children:[e.jsx("input",{ref:s,type:l,className:"form-control",placeholder:d,required:n,defaultValue:u??""}),e.jsx("div",{className:"input-group-text","data-password":"true",onClick:m,children:e.jsx("i",{className:l=="text"?"mdi mdi-eye-off-outline":"mdi mdi-eye-outline"})})]})]})};class O extends I{constructor(){super(...arguments);v(this,"path","admin/coaches")}}const y=({className:t,title:a,icon:s,onClick:d,...n})=>$("<div>").dxButton({hint:a,template:(u,l)=>{l.addClass(`${s} d-block`)},elementAttr:{class:`${t} position-relative me-1 px-1 py-0 tippy-here`,...n},onClick:d}),x=new O,V=({})=>{const t=c.useRef(),a=c.useRef(),s=c.useRef(),d=c.useRef(),n=c.useRef(),u=c.useRef(),l=c.useRef(),i=c.useRef(),m=c.useRef(),p=new T;p.setPublicKey(G.PUBLIC_RSA_KEY);const[f,R]=c.useState(!1),h=async o=>{o.preventDefault();const r=i.current.value,b=m.current.value,E={id:s.current.value||void 0,name:d.current.value,lastname:n.current.value,email:u.current.value,roles:$(l.current).val(),password:r?p.encrypt(r):void 0,confirm:b?p.encrypt(b):void 0};await x.save(E)&&($(t.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},N=async({id:o,status:r})=>{await x.status({id:o,status:r})&&$(t.current).dxDataGrid("instance").refresh()},C=async o=>{await x.delete(o)&&$(t.current).dxDataGrid("instance").refresh()};return e.jsxs(e.Fragment,{children:[e.jsx(q,{gridRef:t,title:"Coaches",rest:x,toolBar:o=>{o.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Nombres"},{dataField:"lastname",caption:"Apellidos"},{dataField:"email",caption:"Correo",dataType:"email",cellTemplate:(o,{data:r})=>{o.append(z([e.jsx("img",{className:"avatar-xs rounded-circle",src:`/api/profile/thumbnail/${r.uuid}`,alt:r.name}),e.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:r.email})],!1))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(o,{data:r})=>{switch(r.status){case 1:g(o,e.jsx("span",{className:"badge bg-success rounded-pill",children:"Activo"}));break;case 0:g(o,e.jsx("span",{className:"badge bg-danger rounded-pill",children:"Inactivo"}));break;default:g(o,e.jsx("span",{className:"badge bg-dark rounded-pill",children:"Eliminado"}));break}}},{caption:"Acciones",cellTemplate:(o,{data:r})=>{o.append(y({className:"btn btn-xs btn-light",title:r.status===null?"Restaurar":"Cambiar estado",icon:r.status===1?"fa fa-toggle-on text-success":r.status===0?"fa fa-toggle-off text-danger":"fas fa-trash-restore",onClick:()=>N(r)})),o.append(y({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>C(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(D,{modalRef:a,title:f?"Editar usuario":"Agregar usuario",onSubmit:h,children:e.jsxs("div",{className:"row",id:"users-crud-container",children:[e.jsx("input",{ref:s,type:"hidden"}),e.jsx(j,{eRef:d,label:"Nombres",col:"col-md-6",required:!0}),e.jsx(j,{eRef:n,label:"Apellidos",col:"col-md-6",required:!0}),e.jsx(j,{eRef:u,label:"Correo",col:"col-12",type:"email",required:!0}),e.jsx(A,{eRef:l,label:"Asignar roles",col:"col-12",dropdownParent:"#users-crud-container",searchAPI:"/api/roles/paginate",searchBy:"name",required:!0,multiple:!0}),e.jsx(w,{eRef:i,label:"Contraseña",col:"col-md-6",required:!f}),e.jsx(w,{eRef:m,label:"Repetir contraseña",col:"col-md-6",required:!f})]})})]})};P((t,a)=>{F(t).render(e.jsx(k,{...a,title:"Coaches",children:e.jsx(V,{...a})}))});
