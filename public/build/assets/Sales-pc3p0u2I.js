var L=Object.defineProperty;var ee=(m,i,d)=>i in m?L(m,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):m[i]=d;var M=(m,i,d)=>(ee(m,typeof i!="symbol"?i+"":i,d),d);import{j as e}from"./AboutHeader-CpM0iYLI.js";import{B as te}from"./Base-DUtpZS4_.js";import{i as O}from"./tippy-react.esm-CHhA99mn.js";import{r as j}from"./index-B80Lgev0.js";import{c as ne}from"./ReactAppend-CBRQCQGz.js";import{S as H}from"./sweetalert2.all-Dh0rZL5X.js";import{m as Z}from"./main-B2CtU6ez.js";import{B as X}from"./BasicRest-Dr9i-95X.js";import{M as se}from"./Modal-B4tqXYU4.js";import{T as re}from"./Table-CJtAc2bi.js";import{D as J}from"./DxButton-CsjWvhyj.js";import{C as ie,G as W}from"./CreateReactScript-DH4VP3S3.js";import{N as f}from"./Number2Currency-e57Tgsuk.js";import{R as U}from"./ReactAppend-C-tNgxIf.js";import{M as ce}from"./Modal-MO8_ThPe.js";import{S as q}from"./SelectFormGroup-DrsZJjJD.js";import{r as le}from"./server.browser-D3N0_gce.js";import{I as u}from"./InputFormGroup-oeTnUpGB.js";import{p as I}from"./places-DAXM8Qkz.js";import{T as K}from"./TextareaFormGroup-BkvHoRll.js";/* empty css              */import"./Logout-CPQZ59pt.js";import"./index.esm-Cu-mVv1q.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./WhatsAppModal-CjZ0YwJN.js";import"./index-DO3Aws4m.js";/* empty css               */class ae extends X{constructor(){super(...arguments);M(this,"path","admin/sale-statuses");M(this,"bySale",async d=>{try{const{status:l,result:o}=await Z.Fetch(`/api/${this.path}/by-sale/${d}`);if(!l)throw new Error((o==null?void 0:o.message)||"Ocurrio un error inesperado");return o.data}catch(l){return Z.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:l.message,type:"danger"}),null}})}}class oe extends X{constructor(){super(...arguments);M(this,"path","admin/sales")}}const Q=({name:m,formula:i,details:d})=>{var o,p,t,F,w,g,D,P,_,v,T,R;const l=d==null?void 0:d.filter(a=>!a.user_formula_id||a.user_formula_id==i.id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{children:"🧐 Tratamiento"}),":"," ",(o=i==null?void 0:i.has_treatment)==null?void 0:o.description]}),e.jsxs("div",{children:[e.jsx("b",{children:"👀 Cuero cabelludo"}),": "," ",(p=i==null?void 0:i.scalp_type)==null?void 0:p.description]}),e.jsxs("div",{children:[e.jsx("b",{children:"✅ Tipo de cabello"}),":"," ",(t=i==null?void 0:i.hair_type)==null?void 0:t.description]}),(i==null?void 0:i.hair_thickness)&&e.jsxs("div",{children:[e.jsx("b",{children:"💪 Grosor del cabello"}),":"," ",(F=i==null?void 0:i.hair_thickness)==null?void 0:F.description]}),e.jsxs("div",{children:[e.jsx("b",{children:"💡 Objetivos"}),":"," ",e.jsx("ul",{className:"mb-0",children:(w=i==null?void 0:i.hair_goals_list)==null?void 0:w.map(a=>e.jsx("li",{children:a.description},a.id))})]}),e.jsxs("div",{children:[e.jsx("b",{children:"🫙 Fragancia"}),":"," ",(g=i==null?void 0:i.fragrance)==null?void 0:g.name]}),e.jsxs("div",{children:[e.jsx("b",{children:"🎨 Colores:"}),e.jsx("ul",{children:l==null?void 0:l.map((a,N)=>{var b,y;return e.jsxs("li",{children:[a.name,((b=a==null?void 0:a.colors)==null?void 0:b.length)>0&&e.jsxs(e.Fragment,{children:[": ",(y=a==null?void 0:a.colors)==null?void 0:y.map(A=>A.name).join(", ")]})]},N)})})]}),e.jsxs("button",{className:"btn btn-xs btn-dark",type:"button",copy:`*Formula ${m}*

🧐 Tratamiento: ${(D=i==null?void 0:i.has_treatment)==null?void 0:D.description}
👀 Cuero cabelludo: ${(P=i==null?void 0:i.scalp_type)==null?void 0:P.description}
✅ Tipo de cabello: ${(_=i==null?void 0:i.hair_type)==null?void 0:_.description}
${i!=null&&i.hair_thickness?`💪 Grosor del cabello: ${(v=i==null?void 0:i.hair_thickness)==null?void 0:v.description}
`:""}💡 Objetivos:
${(T=i==null?void 0:i.hair_goals_list)==null?void 0:T.map(a=>`- ${a.description}`).join(`
`)}
🫙 Fragancia: ${(R=i==null?void 0:i.fragrance)==null?void 0:R.name}
🎨 Colores:
${l==null?void 0:l.map(a=>{var N,b;return`- ${a.name}${((N=a==null?void 0:a.colors)==null?void 0:N.length)>0?`: ${(b=a==null?void 0:a.colors)==null?void 0:b.map(y=>y.name).join(", ")}`:""}`}).join(`
`)}`,children:[e.jsx("i",{className:"mdi mdi-content-copy me-1"}),"Copiar"]})]})},me=({modalRef:m,items:i,phone_prefixes:d=[]})=>{m||(m=j.useRef());const[l,o]=j.useState([]),[p,t]=j.useState([]),[F,w]=j.useState(""),[g,D]=j.useState(null),P=n=>null,_=(n,r)=>0,v=p.reduce((n,r)=>n+r.price*r.quantity,0),T=P(),R=v*0,a=_(),N=v-R-a,b=()=>{t([...p,{id:Date.now(),productId:"",name:"",price:79.9,selectedColors:[],quantity:0}])},y=(n,r)=>{const h=[...p];h[n]={...h[n],item_id:r,colors:[]},t(h)},A=(n,r)=>{const h=[...p];h[n].colors.push(r),t(h)},z=(n,r)=>{const h=[...p],k=h[n];k.colors=k.colors.filter(E=>E.id!==r),t(h)},s=n=>{},c=async()=>{},C=n=>{n.preventDefault(),console.log(l)},S=n=>{if(!n.id)return n.text;const r=n.element.dataset.code,h=n.element.dataset.flag,k=n.element.dataset.country,E=le(e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-emoji text-center",children:h}),e.jsx("b",{className:"ms-1",children:r}),e.jsx("small",{className:"d-block text-truncate",children:k})]}));return $(E)};return e.jsxs(ce,{id:"new-sale-modal",modalRef:m,title:"Nueva venta",size:"lg",isStatic:!0,hideFooter:!0,onSubmit:C,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"mt-0",children:"Información del cliente"}),e.jsxs("div",{className:"row",children:[e.jsx(u,{label:"Nombres",col:"col-md-6",value:l.name,onChange:n=>o(r=>({...r,name:n.target.value})),required:!0}),e.jsx(u,{label:"Apellidos",col:"col-md-6",value:l.lastname,onChange:n=>o(r=>({...r,name:n.target.value})),required:!0})]}),e.jsx(u,{label:"Email",type:"email",value:l.email,onChange:n=>o(r=>({...r,email:n.target.value})),required:!0}),e.jsx("label",{htmlFor:"",className:"form-label",children:"Celular"}),e.jsxs("div",{className:"row",children:[e.jsx(q,{col:"col-md-4",dropdownParent:"#new-sale-modal",minimumInputLength:-1,templateResult:S,templateSelection:S,children:d.sort((n,r)=>n.country.localeCompare(r.country)).map((n,r)=>e.jsxs("option",{value:n.realCode,"data-code":n.beautyCode,"data-flag":n.flag,"data-country":n.country,children:[n.beautyCode," ",n.country]},r))}),e.jsx(u,{col:"col-md-8",type:"tel",value:l.phone,onChange:n=>o(r=>({...r,phone:n.target.value}))})]}),e.jsx("div",{className:"mb-2",children:e.jsxs(q,{label:"Origen de venta",minimumResultsForSearch:-1,dropdownParent:"#new-sale-modal",value:l.source,onChange:n=>o(r=>({...r,source:n.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),e.jsx("option",{value:"Banner",children:"Banner publicitario"}),e.jsx("option",{value:"Facebook",children:"Facebook"}),e.jsx("option",{value:"Instagram",children:"Instagram"}),e.jsx("option",{value:"WhatsApp",children:"WhatsApp"}),e.jsx("option",{value:"TikTok",children:"TikTok"})]})}),e.jsx(K,{label:"Comentario interno",value:l.origin_comment,onChange:n=>o(r=>({...r,origin_comment:n.target.value})),placeholder:"Ingresa un comentario sobre por qué se está creando esta venta..."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"mt-0",children:"Dirección del cliente"}),e.jsx(u,{label:"Pais",value:"Perú",disabled:!0,required:!0}),e.jsxs(q,{label:"Región / Provincia",value:l.department||"",onChange:n=>o(r=>({...r,department:n.target.value})),minimumResultsForSearch:-1,dropdownParent:"#new-sale-modal",required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),Object.keys(I).map((n,r)=>e.jsx("option",{value:n,children:I[n].name},r))]}),I[l.department]&&e.jsxs("div",{className:"row",children:[Array.isArray(I[l.department].items)?e.jsxs(q,{label:"Provincia",col:"col-md-8",dropdownParent:"#new-sale-modal",value:l.province,effectWith:[l.department],onChange:n=>o(r=>({...r,province:n.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),I[l.department].items.map((n,r)=>e.jsx("option",{value:n,children:n},r))]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Departamento",col:"col-md-4",value:l.province,onChange:n=>o(r=>({...r,province:n.target.value})),required:!0}),e.jsx(u,{label:"Distrito",col:"col-md-4",value:l.district,onChange:n=>o(r=>({...r,district:n.target.value})),required:!0})]}),e.jsx(u,{label:"Cód. Postal",col:"col-md-4",value:l.zip_code,onChange:n=>o(r=>({...r,zip_code:n.target.value}))})]}),e.jsxs("div",{className:"row",children:[e.jsx(u,{label:"Dirección",col:"col-md-8",value:l.address,onChange:n=>o(r=>({...r,address:n.target.value})),required:!0}),e.jsx(u,{label:"Número",col:"col-md-4",type:"number",value:l.number,onChange:n=>o(r=>({...r,number:n.target.value}))})]}),e.jsx(u,{label:"Apartamento, habitación, piso, etc.",value:l.reference,onChange:n=>o(r=>({...r,reference:n.target.value}))}),e.jsx(K,{label:"Notas del pedido",value:l.comment,placeholder:"Notas sobre el pedido, por ejemplo, notas especiales para la entrega.",onChange:n=>o(r=>({...r,comment:n.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("h4",{children:"Productos"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-centered table-nowrap",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Color"}),e.jsx("th",{children:"Cant."}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Subtotal"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:p.map((n,r)=>{var E,V;const h=((E=i.find(x=>x.id===n.item_id))==null?void 0:E.colors)||[],k=((V=n.colors)==null?void 0:V.length)??0;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs(q,{noMargin:!0,dropdownParent:"#new-sale-modal",value:n.item_id,onChange:x=>y(r,x.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar producto"}),i.map((x,B)=>e.jsx("option",{value:x.id,children:x.name},B))]})}),e.jsx("td",{style:{width:"150px"},children:e.jsx("div",{className:"d-flex flex-wrap gap-1",children:h.map(x=>{const B=n.colors.filter(Y=>Y.id===x.id).length;return e.jsxs("div",{onClick:()=>A(r,x),className:"position-relative cursor-pointer",children:[e.jsx("div",{className:`rounded-circle position-relative p-2 border ${B>0?"border-primary":""}`,style:{backgroundColor:x.hex}}),B>0&&e.jsx("small",{className:"position-absolute translate-middle badge rounded-pill bg-primary",onClick:Y=>{Y.stopPropagation(),z(r,x.id)},style:{padding:"2px 4px",top:"4px",fontSize:"10px",right:"-12px"},children:B})]},x.id)})})}),e.jsx("td",{children:k}),e.jsxs("td",{children:["S/.",n.price]}),e.jsxs("td",{children:["S/.",(n.price*k).toFixed(2)]}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>s(),children:e.jsx("i",{className:"fa fa-trash"})})})]},r)})}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"text-end",children:"Subtotal:"}),e.jsxs("td",{children:["S/.",v.toFixed(2)]}),e.jsx("td",{})]}),T,g&&e.jsxs("tr",{children:[e.jsxs("td",{colSpan:4,className:"text-end",children:["Cupón (",g.code,"):"]}),e.jsxs("td",{children:["-S/.",a.toFixed(2)]}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"text-end",children:"Total:"}),e.jsxs("td",{children:["S/.",N.toFixed(2)]}),e.jsx("td",{})]})]})]})}),e.jsxs("div",{className:"row mt-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:b,children:[e.jsx("i",{className:"fa fa-plus me-1"}),"Agregar producto"]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Código de cupón",value:F,onChange:n=>w(n.target.value)}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:c,children:"Aplicar cupón"})]})})]})]})]}),e.jsxs("div",{className:"text-end mt-4",children:[e.jsx("button",{type:"button",className:"btn btn-light me-2",onClick:()=>$(m.current).modal("hide"),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Guardar venta"})]})]})},G=new oe,de=new ae,he=({statuses:m,items:i,phone_prefixes:d})=>{var T,R,a,N,b,y,A,z;const l=j.useRef(),o=j.useRef(),p=j.useRef(),[t,F]=j.useState(null),[w,g]=j.useState([]),D=async s=>{const c=s.target.value,C=$(s.target).find(`option[value="${c}"]`);if(C.data("confirm")){const{isConfirmed:r}=await H.fire({title:"Actualizar estado",text:`¿Estás seguro de actualizar la venta al estado "${C.text()}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Si, actualizar",cancelButtonText:"Cancelar"});if(!r)return}const n=await G.save({id:t.id,status_id:c});n&&(F(n.data),$(l.current).dxDataGrid("instance").refresh())},P=async s=>{const{isConfirmed:c}=await H.fire({title:"Anular pedido",text:"¿Estas seguro de anular este pedido?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, anular",cancelButtonText:"Cancelar"});!c||!await G.delete(s)||$(l.current).dxDataGrid("instance").refresh()},_=async s=>{g([]);const c=await G.get(s);F(c),$(o.current).modal("show")};j.useEffect(()=>{t&&de.bySale(t.id).then(s=>{g(s||[])})},[t]),Number(t==null?void 0:t.amount)+Number(t==null?void 0:t.delivery)-Number(t==null?void 0:t.bundle_discount)-Number(t==null?void 0:t.renewal_discount)-Number(t==null?void 0:t.coupon_discount);const v=t!=null&&t.phone.clean("0-9").startsWith("51")?t==null?void 0:t.phone.clean("0-9"):`51${t==null?void 0:t.phone.clean("0-9")}`;return e.jsxs(e.Fragment,{children:[e.jsx(re,{gridRef:l,title:"Pedidos",rest:G,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(l.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"Agrega una venta manual",text:"Nueva venta",onClick:()=>$(p.current).modal("show")}})},exportable:!0,pageSize:25,columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"code",caption:"Numero de orden",visible:!1},{dataField:"created_at",caption:"Fecha",dataType:"date",sortOrder:"desc",width:"150px",cellTemplate:(s,{data:c})=>{s.css("cursor","pointer"),s.on("click",()=>{_(c.id)}),U(s,e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"d-block",children:moment(c.created_at.replace("Z","-05:00")).fromNow()}),e.jsx("small",{className:"d-block text-muted",children:moment(c.created_at).format("lll")})]}))}},{dataField:"fullname",caption:"Orden",width:"250px",cellTemplate:(s,{data:c})=>{s.css("cursor","pointer"),s.on("click",()=>{_(c.id)}),U(s,e.jsxs("p",{className:"mb-0",style:{width:"100%"},children:[e.jsxs("b",{className:"d-block w-100 text-truncate",children:[c.renewal&&e.jsx(O,{content:`Plan: ${c.renewal.name}`,children:e.jsx("i",{className:"fa fas fa-spa text-pink me-1"})}),c.name," ",c.lastname]}),e.jsxs("small",{className:"text-nowrap text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,fontFamily:"monospace"},children:["#",W.APP_CORRELATIVE,"-",c.code]})]}))}},{dataField:"status.name",caption:"Estado",width:"100px",cellTemplate:(s,{data:c})=>{U(s,e.jsx(e.Fragment,{children:e.jsx(O,{content:c.status.description,children:e.jsx("span",{className:"d-block mx-auto badge rounded-pill",style:{backgroundColor:c.status.color?`${c.status.color}2e`:"#3333332e",color:c.status.color??"#333",width:"max-content",marginBottom:"4px"},children:c.status.name})})}))}},{dataField:"total_amount",caption:"Total",dataType:"number",width:"100px",cellTemplate:(s,{data:c})=>{s.text(`S/. ${f(c.total_amount)}`)}},{dataField:"phone",caption:"Teléfono",width:"120px",cellTemplate:(s,{data:c})=>{s.text(c.phone.keep("0-9"))}},{dataField:"email",caption:"Email"},{dataField:"department",caption:"Departamento"},{dataField:"province",caption:"Ciudad",cellTemplate:(s,{data:c})=>{s.text(c.province||c.district)}},{caption:"Acciones",cellTemplate:(s,{data:c})=>{s.append(J({className:"btn btn-xs btn-light",title:"Ver pedido",icon:"fa fa-eye",onClick:()=>_(c.id)})),!c.status.confirm&&s.append(J({className:"btn btn-xs btn-soft-danger",title:"Anular pedido",icon:"fa fa-trash",onClick:()=>P(c.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(se,{modalRef:o,title:`Detalles del pedido #${W.APP_CORRELATIVE}-${t==null?void 0:t.code}`,size:"xl",bodyStyle:{backgroundColor:"#ebeff2"},hideButtonSubmit:!0,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Detalles de Venta"})}),e.jsxs("div",{className:"card-body p-2",children:[e.jsx("table",{id:"table-info",className:"table table-borderless table-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Nombres:"}),e.jsxs("td",{children:[t==null?void 0:t.name," ",t==null?void 0:t.lastname]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Email:"}),e.jsx("td",{children:t==null?void 0:t.email})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Teléfono:"}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-1 align-items-center",children:[e.jsx("img",{className:"avatar-sm rounded-circle",src:`${W.WA_URL}/api/profile/${W.APP_CORRELATIVE}/${v}`,onError:s=>{s.target.onerror=null,s.target.src="/api/admin/profile/thumbnail/undefined"},alt:(t==null?void 0:t.name)+" "+(t==null?void 0:t.lastname)}),e.jsxs("div",{children:[e.jsx("span",{className:"d-block",children:t==null?void 0:t.phone}),e.jsx("a",{href:`//wa.me/${v}`,target:"_blank",children:e.jsxs("small",{children:["Abrir WhatsApp ",e.jsx("i",{className:"mdi mdi-arrow-top-right"})]})})]})]})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Dirección:"}),e.jsxs("td",{children:[t==null?void 0:t.address," ",t==null?void 0:t.number,e.jsxs("small",{className:"text-muted d-block",children:[(t==null?void 0:t.province)??(t==null?void 0:t.district),", ",t==null?void 0:t.department,", ",t==null?void 0:t.country," ",(t==null?void 0:t.zip_code)&&e.jsxs(e.Fragment,{children:["- ",t==null?void 0:t.zip_code]})]})]})]}),(t==null?void 0:t.reference)&&e.jsxs("tr",{children:[e.jsx("th",{children:"Referencia:"}),e.jsx("td",{children:t==null?void 0:t.reference})]}),(t==null?void 0:t.comment)&&e.jsxs("tr",{children:[e.jsx("th",{children:"Comentario:"}),e.jsx("td",{children:t==null?void 0:t.comment})]}),(t==null?void 0:t.billing_type)&&(t==null?void 0:t.billing_number)&&e.jsxs("tr",{children:[e.jsx("th",{children:"Comprobante:"}),e.jsxs("td",{children:[e.jsx("b",{className:"d-block",children:t.billing_type.toTitleCase()}),e.jsxs("small",{children:[e.jsx("code",{className:"me-1",children:t.billing_type=="boleta"?"DNI":"RUC"}),e.jsx("span",{children:t==null?void 0:t.billing_number})]})]})]})]})}),e.jsxs("button",{className:"btn btn-xs btn-dark",type:"button",copy:`Nombres: ${t==null?void 0:t.fullname}
Email: ${t==null?void 0:t.email}
Teléfono: ${t==null?void 0:t.phone}
Dirección: ${t==null?void 0:t.address} ${t==null?void 0:t.number}${t!=null&&t.zip_code?`
Código Postal: ${t==null?void 0:t.zip_code}`:""}
Ubicación: ${(t==null?void 0:t.province)??(t==null?void 0:t.district)}, ${t==null?void 0:t.department}, ${t==null?void 0:t.country}${t!=null&&t.reference?`
Referencia: ${t==null?void 0:t.reference}`:""}${t!=null&&t.comment?`
Comentario: ${t==null?void 0:t.comment}`:""}${t!=null&&t.billing_type&&(t!=null&&t.billing_number)?`
Comprobante: ${t.billing_type.toTitleCase()}
${t.billing_type=="boleta"?"DNI":"RUC"}: ${t==null?void 0:t.billing_number}`:""}`,children:[e.jsx("i",{className:"mdi mdi-content-copy me-1"}),"Copiar"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Artículos"})}),e.jsx("div",{className:"card-body p-2 table-responsive",children:e.jsxs("table",{className:"table table-striped table-bordered table-sm table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Colores"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:(T=t==null?void 0:t.details)==null?void 0:T.map((s,c)=>{var n;const C=s.quantity*100/100,S=s.price*s.quantity;return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("span",{className:"d-block",children:s.name}),s.user_formula_id&&s.user_formula_id!=t.user_formula_id&&e.jsx(O,{content:e.jsx(Q,{name:t==null?void 0:t.name,details:t==null?void 0:t.details,formula:s.user_formula}),allowHTML:!0,interactive:!0,children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-flask me-1"}),"Fórmula secundaria"]})})]}),e.jsx("td",{children:(n=s==null?void 0:s.colors)==null?void 0:n.map((r,h)=>e.jsx(O,{content:r.name,children:e.jsx("i",{className:"mdi mdi-circle",style:{color:r.hex,WebkitTextStroke:"1px #808080"}})},h))}),e.jsxs("td",{align:"right",children:["S/ ",f(s.price)]}),e.jsx("td",{align:"center",children:C}),e.jsxs("td",{align:"right",children:["S/ ",f(S)]})]},c)})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Resumen"})}),e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Subtotal:"}),e.jsxs("span",{children:["S/ ",f(t==null?void 0:t.amount)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Envío:"}),e.jsx("span",{children:(t==null?void 0:t.delivery)===null?"Pago en destino":e.jsxs(e.Fragment,{children:["S/ ",f(t==null?void 0:t.delivery)]})})]}),(t==null?void 0:t.bundle)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Descuento x paquete:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:["Elegiste ",(R=t==null?void 0:t.bundle)==null?void 0:R.name," (-",((a=t==null?void 0:t.bundle)==null?void 0:a.percentage)*1e4/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",f(t==null?void 0:t.bundle_discount)]})]}),(t==null?void 0:t.renewal)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Subscripción:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:[(N=t==null?void 0:t.renewal)==null?void 0:N.name," (-",((b=t==null?void 0:t.renewal)==null?void 0:b.percentage)*1e4/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",f(t==null?void 0:t.renewal_discount)]})]}),(t==null?void 0:t.coupon)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Cupón aplicado:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:[(y=t==null?void 0:t.coupon)==null?void 0:y.name," (-",((A=t==null?void 0:t.coupon)==null?void 0:A.amount)*100/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",f(t==null?void 0:t.coupon_discount)]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Total:"}),e.jsx("span",{children:e.jsxs("strong",{children:["S/ ",f(t==null?void 0:t.total_amount)]})})]})]})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Formula principal"})}),e.jsx("div",{className:"card-body p-2",children:e.jsx(Q,{name:t==null?void 0:t.name,details:t==null?void 0:t.details,formula:t==null?void 0:t.formula})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Estado"})}),e.jsx("div",{className:"card-body p-2",children:e.jsxs("div",{className:"",children:[e.jsx("label",{htmlFor:"statusSelect",className:"form-label",children:"Estado Actual"}),e.jsx("select",{className:"form-select",id:"statusSelect",value:t==null?void 0:t.status_id,onChange:D,disabled:!((z=t==null?void 0:t.status)!=null&&z.reversible),children:m.map((s,c)=>e.jsx("option",{value:s.id,"data-confirm":!!s.confirm,children:s.name},c))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Cambios de Estado"})}),e.jsx("div",{className:"card-body p-2 d-flex flex-column gap-1",style:{maxHeight:"300px",overflowY:"auto"},children:w==null?void 0:w.map((s,c)=>{var S,n,r;const C=`${((S=s.user)==null?void 0:S.name)||""} ${((n=s.user)==null?void 0:n.lastname)||""}`.trim()||"Automático";return e.jsxs("article",{className:"border py-1 px-2 ms-3",style:{position:"relative",borderRadius:"16px 4px 4px 16px",backgroundColor:s.status.color?`${s.status.color}2e`:"#3333332e"},children:[e.jsx("i",{className:"mdi mdi-circle left-2",style:{color:s.status.color||"#333",position:"absolute",left:"-25px",top:"50%",transform:"translateY(-50%)"}}),e.jsx("b",{style:{color:s.status.color||"#333"},children:(r=s==null?void 0:s.status)==null?void 0:r.name}),e.jsx("small",{className:"d-block text-truncate",children:C}),e.jsx("small",{className:"d-block text-muted",children:moment(s.created_at).format("YYYY-MM-DD HH:mm")})]},c)})})]})]})]})}),e.jsx(me,{modalRef:p,items:i,phone_prefixes:d})]})};ie((m,i)=>{ne(m).render(e.jsx(te,{...i,title:"Pedidos",children:e.jsx(he,{...i})}))});
