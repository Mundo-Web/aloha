var j=Object.defineProperty;var R=(o,a,r)=>a in o?j(o,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[a]=r;var m=(o,a,r)=>(R(o,typeof a!="symbol"?a+"":a,r),r);import{j as t}from"./StatisticCard-Bdo2C3ON.js";import{r as d}from"./index-DFv2mRv-.js";import{c as w}from"./ReactAppend-CwiwA4iz.js";import{B as v}from"./Base-zNxy_CdJ.js";import{C}from"./CreateReactScript-yWJ4gJYl.js";import{T as N}from"./Table-oGMX5V8i.js";import{R as c}from"./ReactAppend-CaRiPI_F.js";import{D as f}from"./DxButton-CsjWvhyj.js";import{B as S}from"./Content-DtiuTMAn.js";import{S as p}from"./sweetalert2.all-DCeKQPlA.js";import{r as B}from"./DxBox-PA__dqjs.js";import{i as F}from"./tippy-react.esm-BVvHiWwH.js";import{M as T}from"./Modal-D1Rs9-bN.js";import"./index-DgyC5pTR.js";/* empty css              */import"./main-BBbUrZUL.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./index.esm-B502ZfUP.js";/* empty css               */import"./InputFormGroup-z0D3_N8V.js";class k extends S{constructor(){super(...arguments);m(this,"path","coach/requests")}}const h=new k,z=()=>{const o=d.useRef(),[a,r]=d.useState(1),[x,b]=d.useState(null),g=async s=>{const{value:e}=await p.fire({title:"Rechazar solicitud",html:B(t.jsxs("div",{style:{fontSize:"medium"},children:[t.jsxs("div",{class:"form-group mb-2",children:[t.jsx("label",{htmlFor:"reason-select",style:{marginBottom:"4px"},children:"Razón"}),t.jsxs("select",{id:"reason-select",class:"form-select",style:{width:"100%"},children:[t.jsx("option",{value:"",children:"Seleccione una razón"}),t.jsx("option",{value:"sin-accion",children:"Contacto sin acción"}),t.jsx("option",{value:"no-contacto",children:"No se pudo contactar"}),t.jsx("option",{value:"otro",children:"Otro"})]})]}),t.jsxs("div",{className:"form-group",id:"other-reason",style:{display:"none"},children:[t.jsx("label",{htmlFor:"other-reason-input",style:{marginBottom:"4px"},children:"Especifique"}),t.jsx("textarea",{id:"other-reason-input",class:"form-control",placeholder:"Especifique la razón",style:{minHeight:"27px",fieldSizing:"content"}})]})]})),focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",didOpen:()=>{$("#reason-select").select2({dropdownParent:$(".swal2-container"),width:"100%"}),$("#reason-select").on("change",function(){const n=$("#other-reason");$(this).val()==="otro"?n.show():n.hide()}),$(".select2-container").css("width","100%")},preConfirm:()=>{const n=$("#reason-select").val(),u=$("#other-reason-input").val();return n?n==="otro"&&!u.trim()?(p.showValidationMessage("Por favor, especifique la razón"),!1):{selectedReason:n,otherReason:n==="otro"?u:""}:(p.showValidationMessage("Por favor, seleccione una razón"),!1)}});if(!e)return;let i;switch(e.selectedReason){case"sin-accion":i="Contacto sin acción";break;case"no-contacto":i="No se pudo contactar";break;case"otro":i=e.otherReason;break}await h.save({id:s,status:null,status_message:i})&&$(o.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(N,{gridRef:o,title:"Solicitudes",rest:h,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(o.current).dxDataGrid("instance").refresh()}})},onRefresh:({summary:s})=>{s!=null&&s.contract_number&&r(s.contract_number)},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"coachee.name",caption:"Nombres"},{dataField:"coachee.lastname",caption:"Apellidos"},{dataField:"coachee.email",caption:"Correo"},{dataField:"coachee.phone",caption:"Telefono",cellTemplate:(s,{data:e})=>{var i,l,n;(i=e==null?void 0:e.coachee)!=null&&i.phone?s.text(`${((l=e==null?void 0:e.coachee)==null?void 0:l.phone_prefix)||"51"}${((n=e==null?void 0:e.coachee)==null?void 0:n.phone)||""}`):c(s,t.jsx("i",{className:"text-muted",children:"- Sin telefono -"}))}},{dataField:"updated_at",caption:"Fecha",dataType:"date",cellTemplate:(s,{data:e})=>{s.text(moment(e.updated_at).format("LL"))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(s,{data:e})=>{switch(e.status){case 1:c(s,t.jsx("span",{className:"badge bg-success rounded-pill",children:"Atendido"}));break;case 0:c(s,t.jsx("span",{className:"badge bg-dark rounded-pill",children:"Pendiente"}));break;default:c(s,t.jsx("span",{className:"badge bg-danger rounded-pill",children:"Rechazado"}));break}e.status==null&&c(s,t.jsx(F,{content:e.status_message,children:t.jsx("p",{className:"mb-0 text-truncate text-muted",children:e.status_message})}))}},{caption:"Acciones",cellTemplate:(s,{data:e})=>{s.css("text-overflow","unset"),e.status==0&&(s.append(f({className:"btn btn-xs btn-soft-primary",title:"Redactar acuerdo",icon:"fa fas fa-file-signature",onClick:()=>onModalOpen({request_id:e.id,contract_number:a})})),s.append(f({className:"btn btn-xs btn-soft-danger",title:"Rechazar",icon:"fa fa-times",onClick:()=>g(e.id)})))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(T,{dataLoaded:x,setDataLoaded:b,onSave:()=>$(o.current).dxDataGrid("instance").refresh()})]})};C((o,a)=>{w(o).render(t.jsx(v,{...a,title:"Solicitudes",children:t.jsx(z,{...a})}))});
