var re=Object.defineProperty;var le=(c,m,N)=>m in c?re(c,m,{enumerable:!0,configurable:!0,writable:!0,value:N}):c[m]=N;var R=(c,m,N)=>(le(c,typeof m!="symbol"?m+"":m,N),N);import{j as e}from"./AboutHeader-CpM0iYLI.js";import{r as S}from"./index-B80Lgev0.js";import{c as ne}from"./ReactAppend-CBRQCQGz.js";import{B as ie}from"./Base-B5R6_Zr-.js";import{G as Y,C as ce}from"./CreateReactScript-DH4VP3S3.js";import{m as q}from"./main-B2CtU6ez.js";import{i as z}from"./tippy-react.esm-CHhA99mn.js";import{A as Z}from"./CallToAction-Y9yYs4wC.js";import{N as D}from"./Number2Currency-e57Tgsuk.js";import{N as de}from"./NewFormulaButton-i0Ux9JQQ.js";import{U as oe}from"./UserFormulasRest-CUuZlsfm.js";import{S as W}from"./sweetalert2.all-Dh0rZL5X.js";import{C as me}from"./CouponsRest-CF_zR6Xf.js";import{p as E}from"./places-DAXM8Qkz.js";import{c as T}from"./createLucideIcon-Cx5eUsrb.js";import"./index-DO3Aws4m.js";import"./Base-ku_qAI12.js";import"./index-B1nVdsa0.js";import"./index-CqrOtH36.js";import"./index.esm-Cu-mVv1q.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";/* empty css               *//* empty css              */import"./BasicRest-Dr9i-95X.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=T("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=T("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=T("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);class I{}R(I,"order",async(m,N)=>{try{const{status:v,result:g}=await q.Fetch("/api/culqi/order",{method:"POST",body:q.JSON.stringify({sale:m,details:N})});if(!v)throw new Error((g==null?void 0:g.message)||"Ocurrio un error inesperado");return q.Notify.add({icon:"/assets/img/favicon.png",title:"Correcto",body:g.message,type:"success"}),g}catch(v){return q.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:v.message,type:"danger"}),null}}),R(I,"token",async m=>{try{const{status:N,result:v}=await q.Fetch("/api/culqi/token",{method:"POST",body:q.JSON.stringify(m)});if(!N)throw new Error((v==null?void 0:v.message)||"Ocurrio un error inesperado");return q.Notify.add({icon:"/assets/img/favicon.png",title:"Correcto",body:v.message,type:"success"}),v}catch(N){return q.Notify.add({icon:"/assets/img/favicon.png",title:"Error",body:N.message,type:"danger"}),null}});const he=({formula:c,otherFormulas:m,goToNextPage:N,goToPrevPage:v,items:g=[],defaultColors:$={},setSelectedPlan:F})=>{const[l,M]=S.useState((q.Local.get("vua_cart")??[]).filter(f=>!!f.formula_id));S.useEffect(()=>{M(f=>f.map(j=>{var _;const x=((_=g.find(C=>C.id==j.id))==null?void 0:_.colors)??[],n=j.colors??[],d=j.quantity,p=d-n.length,y=structuredClone(x).sort((C,r)=>$[j.id]==C.id?-1:1),h=new Array(p>0?p:0).fill((y==null?void 0:y[0])??null);return n.length<d?j.colors=[...n,...h].filter(Boolean):j.colors=n.slice(0,d).filter(Boolean),j}))},[null]);const w=(f,j,x,n)=>{const d=n??(c==null?void 0:c.id);M(p=>p.map(y=>(y.id==f&&y.formula_id==d&&(y.colors[j]=x),y)))},k=()=>{m.length>0?(F(null),N(2)):N()};return S.useEffect(()=>{q.Local.set("vua_cart",l)},[l]),S.useEffect(()=>{Z.init()},[null]),e.jsxs("section",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center text-[#404040]",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Ahora selecciona el color!"}),e.jsxs("p",{className:"mb-8 text-sm font-extralight",children:[e.jsx("span",{children:"Elije tus colores favoritos para tu rutina"}),e.jsx("img",{className:"w-4 inline-block ms-2",src:"/assets/img/emojis/stars.png",alt:"Elije tus colores favoritos para tu rutina"})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-5 mt-5 sm:mt-8 lg:mt-10",children:l.sort((f,j)=>{const x=m.find(d=>d.id==f.formula_id)??c,n=m.find(d=>d.id==j.formula_id)??c;return x.created_at<n.created_at?-1:1}).map((f,j)=>{var p,y;const x=m.findIndex(h=>h.id==f.formula_id)+1,n=m.find(h=>h.id==f.formula_id)??c,d=((p=g.find(h=>h.id==f.id))==null?void 0:p.colors)??[];return d.length==0?null:(y=f.colors)==null?void 0:y.map((h,_)=>e.jsx("div",{className:"overflow-hidden w-full md:w-[calc(50%-10px)] lg:w-[calc(33.333%-13.33px)] bg-white rounded-2xl shadow-md","data-aos":"fade-down",children:e.jsxs("div",{className:"flex flex-row gap-2 items-center p-2",children:[e.jsx("div",{className:"",children:e.jsx("img",{className:"h-[120px] aspect-[3/4] object-cover object-center rounded-md",src:`/api/colors/media/${h==null?void 0:h.image}`,alt:f.name})}),e.jsx("div",{className:"",children:e.jsx("div",{className:"flex flex-wrap gap-3 items-end self-stretch my-auto ",children:e.jsxs("div",{className:"flex flex-col items-start self-stretch",children:[e.jsxs("small",{className:"block mb-1 font-bold",children:[e.jsx("i",{className:"mdi mdi-flask me-1"}),x==0?"Fórmula principal":e.jsxs(e.Fragment,{children:[x+1,e.jsx("sup",{children:"a"})," fórmula"]})]}),e.jsxs("h2",{className:"text-lg font-semibold tracking-normal leading-none text-neutral-700 mb-2",children:[f.name," ",_+1]}),e.jsx("p",{className:" text-sm font-light tracking-normal leading-none text-neutral-700 mb-2",children:"Selecciona tu color:"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:d.map((C,r)=>{const i=(h==null?void 0:h.id)==C.id;return e.jsx(z,{content:C.name,children:e.jsx("button",{className:`flex shrink-0 w-8 aspect-square rounded-full border ${i?"shadow-md border-[#000000]":""}`,style:{backgroundColor:C.hex||"#fff"},onClick:()=>w(f.id,_,C,n.id)})},r)})})]})})})]})},`existence-${j}-${_}`))}).filter(Boolean)}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:[e.jsxs("button",{onClick:()=>v(),className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsxs("button",{onClick:k,className:"bg-[#C5B8D4] text-white text-sm px-14 py-3 rounded mt-4",children:["SIGUIENTE",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]})]})]})},be=({otherFormulas:c,goToNextPage:m,goToPrevPage:N,setSelectedPlan:v,bundles:g=[],planes:$=[],session:F})=>{const l=q.Local.get("vua_cart")??[],M=l.reduce((n,d)=>n+d.price*d.quantity,0),w=l.reduce((n,d)=>n+d.quantity,0),k=g.filter(n=>{switch(n.comparator){case"<":return w<n.items_quantity;case">":return w>n.items_quantity;default:return w==n.items_quantity}}).sort((n,d)=>d.percentage-n.percentage),f=(k==null?void 0:k[0])??null,j=Math.round(M*(1-((f==null?void 0:f.percentage)||0))*10)/10,x=n=>{v(n),m()};return S.useEffect(()=>{c.length>0&&x(null)},[null]),e.jsxs("section",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Elije la frecuencia de tu pedido!"}),e.jsx("p",{className:"mb-8 text-sm font-extralight",children:"Conoce de qué manera puedes ahorrar en tu rutina"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4 mt-5 sm:mt-8 lg:mt-10 items-center justify-center",children:[e.jsxs("div",{className:"transition-all cursor-pointer p-6 bg-white group hover:bg-[#EFBEC1] hover:text-white rounded-2xl grid grid-cols-2 items-center justify-between gap-4 shadow-md h-full",onClick:()=>x(null),children:[e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"block font-extralight",children:"Comprar por"}),e.jsx("span",{className:"block font-bold mb-2 -mt-1 text-[#303030]",children:"1 sola vez"})]}),e.jsx("div",{className:"flex flex-col gap-2 text-end",children:e.jsxs("span",{className:"ms-auto text-4xl text-[#C0AFD4] group-hover:text-white font-extrabold tracking-tighter",children:["S/",D(j)]})})]}),c.length==0&&e.jsx(e.Fragment,{children:!(F!=null&&F.id)&&$.length>0?e.jsxs("div",{className:"p-4 text-center flex flex-col gap-2 items-center",children:[e.jsxs("span",{children:["o inicia sesion para acceder a ",e.jsx("br",{}),e.jsx("b",{children:"planes de suscripcion"})]}),e.jsx("button",{href:"/login",className:"block rounded-full px-3 py-2 bg-[#A191B8] text-white text-sm uppercase",children:"Iniciar sesion"})]}):$.sort((n,d)=>d.percentage-n.percentage).map((n,d)=>{const p=Math.round((j-j*n.percentage)*10)/10;return e.jsxs("div",{className:"cursor-pointer p-6 bg-white transition-all rounded-2xl grid grid-cols-2 items-center justify-between gap-4 shadow-md h-full hover:bg-[#EFBEC1] hover:text-white peer-checked:bg-[#EFBEC1] peer-checked:text-white group",onClick:()=>x(n.id),children:[e.jsxs("div",{className:"text-start",children:[e.jsx("span",{className:"block",children:"Suscripción"}),e.jsxs("span",{className:"block font-bold mb-2 -mt-1",children:["Cada ",n.name]}),e.jsx("div",{className:"border border-[#404040] text-xs px-2 py-1 rounded-full w-max  group-hover:border-white peer-checked:border-white ",children:"+ Envío gratis Lima Met."})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-end",children:[e.jsxs("span",{className:"ms-auto text-nowrap text-xs px-2 py-1 rounded-full w-max text-white bg-[#C0AFD4] group-hover:text-[#EEA9D2] group-hover:bg-white peer-checked:text-[#EEA9D2] peer-checked:bg-white ",children:["-",n.percentage*100,"%OFF",e.jsx("img",{className:"w-3 inline-block ms-1",src:"/assets/img/emojis/fire.png",alt:"-{plan.percentage * 100}%OFF"})]}),e.jsxs("span",{className:"ms-auto text-4xl text-[#C0AFD4] font-bold group-checked:text-white group-hover:text-white",children:["S/",D(p)]})]})]},d)})})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:e.jsxs("button",{onClick:()=>N(),className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]})})]})},ge=new oe,fe=({formula:c,otherFormulas:m,setOtherFormulas:N,goToNextPage:v,items:g=[],bundles:$=[],freeShipping:F,freeShippingBannerText:l})=>{const M=q.Local.get("vua_cart")??g.map(r=>{const i=structuredClone(r);if(delete i.colors,!!i.is_default)return i.quantity=1,i.formula_id=c.id,i}).filter(Boolean),[w,k]=S.useState(M.filter(r=>!!g.find(i=>r.id==i.id))??[]),f=w.reduce((r,i)=>r+i.price*i.quantity,0),j=(r,i,o)=>{const b=o??c.id,a=r.target.checked;k(a?u=>[...u,{...i,quantity:1,formula_id:b}]:u=>u.filter(P=>!(P.id==i.id&&P.formula_id==b)))},x=w.reduce((r,i)=>r+i.quantity,0),n=$.filter(r=>{switch(r.comparator){case"<":return x<r.items_quantity;case">":return x>r.items_quantity;default:return x==r.items_quantity}}).sort((r,i)=>i.percentage-r.percentage),d=(n==null?void 0:n[0])??null,p=Math.round(f*(1-((d==null?void 0:d.percentage)||0))*10)/10,y=(r,i)=>{const o=i??c.id;w.find(b=>b.id==r.id&&b.formula_id==o)?k(b=>b.map(a=>(a.id==r.id&&a.formula_id==o&&a.quantity++,a))):(document.getElementById(`item-${r.id}`).checked=!0,k(b=>[...b,{...r,quantity:1,formula_id:o}]))},h=(r,i)=>{const o=i??c.id;k(b=>b.map(a=>(a.id==r.id&&a.formula_id==o&&a.quantity--,a.quantity<=0?document.getElementById(`item-${r.id}`).checked=!1:a)).filter(Boolean))},_=async r=>{const{isConfirmed:i}=await W.fire({title:"¿Estás seguro?",text:"¿Estás seguro de eliminar esta fórmula?",showCancelButton:!0,confirmButtonColor:"#71b6f9",cancelButtonColor:"#d94d4d",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!i||!await ge.delete(r)||(N(b=>b.filter(a=>a.id!=r)),k(b=>b.filter(a=>a.formula_id!=r)))},C=async()=>{const r=w.some(o=>o.formula_id===c.id),i=m.every(o=>w.some(b=>b.formula_id===o.id));if(!r||!i){await W.fire({title:"¡Hay una fórmula vacía!",text:"Selecciona al menos un producto por fórmula.",confirmButtonColor:"#71b6f9",confirmButtonText:"Entendido"});return}v()};return S.useEffect(()=>{q.Local.set("vua_cart",w)},[w]),S.useEffect(()=>{Z.init()},[null]),e.jsxs("form",{className:"px-[3%] lg:px-[10%] py-[10%] md:py-[7.5%] lg:py-[5%] bg-[#F9F3EF] text-center text-[#404040]",children:[e.jsxs("div",{className:"max-w-2xl mx-auto ",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"¡Selecciona tus productos personalizados!"}),e.jsxs("p",{className:"mb-8 text-sm font-extralight",children:[e.jsx("span",{children:"Para mejores resultados arma una rutina completa"}),e.jsx("img",{className:"w-4 inline-block ms-2",src:"/assets/img/emojis/stars.png",alt:"Para mejores resultados arma una rutina completa"})]})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"block w-1/2 mx-auto mb-4"}),e.jsxs("h2",{className:"text-xl mb-6",children:["Productos para tu ",e.jsx("b",{children:"fórmula principal"})]})]}),e.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:g.map((r,i)=>{const o=structuredClone(r);delete o.colors;const b=w.find(u=>u.id==o.id&&u.formula_id==c.id),a=(b==null?void 0:b.quantity)??0;return e.jsxs("div",{className:"flex flex-col w-[180px] whitespace-nowrap","data-aos":"fade-up",children:[e.jsx("input",{type:"checkbox",name:"",id:`item-${o.id}`,className:"peer hidden",onChange:u=>j(u,o),checked:!!b,required:!0}),e.jsxs("label",{htmlFor:`item-${o.id}`,className:"flex overflow-hidden flex-col tracking-normal leading-none text-center bg-white rounded-xl border peer-checked:border-[#808080] peer-checked:shadow-md text-[#404040] cursor-pointer mb-3 transition-all",children:[e.jsx("img",{loading:"lazy",src:`/api/items/media/${o.image}`,className:"object-cover object-center aspect-[3/4] w-full border-b",alt:"Shampoo product image",onError:u=>u.target.src="/assets/img/routine/conditioner.png"}),e.jsx("h2",{className:"self-center px-4 py-3",children:o.name})]}),e.jsxs("div",{className:"flex gap-5 justify-between items-center self-center py-1 text-sm bg-transparent rounded-lg border border-[#808080] w-[70%] px-4 font-bold",children:[e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>h(o),disabled:a<=0,children:"-"}),e.jsx("span",{children:a}),e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>y(o),children:"+"})]})]},i)})})}),m.length>0&&m.map((r,i)=>e.jsxs("div",{className:"max-w-4xl mx-auto mb-8",children:[e.jsxs("h2",{className:"text-xl mb-6",children:["Productos para tu ",e.jsxs("b",{children:[i+2,e.jsx("sup",{children:"a"})," fórmula"]}),e.jsx(z,{content:"Eliminar esta fórmula",children:e.jsx("i",{className:"mdi mdi-trash-can-outline text-red-400 font-bold ms-2 cursor-pointer",onClick:()=>_(r.id)})})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:g.map((o,b)=>{const a=structuredClone(o);delete a.colors;const u=w.find(A=>A.id==a.id&&A.formula_id==r.id),P=(u==null?void 0:u.quantity)??0;return e.jsxs("div",{className:"flex flex-col w-[180px] whitespace-nowrap","data-aos":"fade-up",children:[e.jsx("input",{type:"checkbox",name:"",id:`item-${a.id}-${r.id}`,className:"peer hidden",onChange:A=>j(A,a,r.id),checked:!!u,required:!0}),e.jsxs("label",{htmlFor:`item-${a.id}-${r.id}`,className:"flex overflow-hidden flex-col tracking-normal leading-none text-center bg-white rounded-xl border peer-checked:border-[#808080] peer-checked:shadow-md text-[#404040] cursor-pointer mb-3 transition-all",children:[e.jsx("img",{loading:"lazy",src:`/api/items/media/${a.image}`,className:"object-cover object-center aspect-[3/4] w-full border-b",alt:"Shampoo product image",onError:A=>A.target.src="/assets/img/routine/conditioner.png"}),e.jsx("h2",{className:"self-center px-4 py-3",children:a.name})]}),e.jsxs("div",{className:"flex gap-5 justify-between items-center self-center py-1 text-sm bg-transparent rounded-lg border border-[#808080] w-[70%] px-4 font-bold",children:[e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>h(a,r.id),disabled:P<=0,children:"-"}),e.jsx("span",{children:P}),e.jsx("button",{type:"button",className:"disabled:cursor-not-allowed",onClick:()=>y(a,r.id),children:"+"})]})]},b)})})]},i)),(m==null?void 0:m.length)<3&&e.jsx(de,{formula:c,roundedFull:!0,showIcon:!0}),e.jsxs("div",{className:"max-w-2xl mx-auto mt-5 sm:mt-8 lg:mt-10 px-[3%]",children:[e.jsxs("p",{className:"text-md",children:["Agrega más de un producto y ",e.jsx("b",{children:"obtén nuestros descuentos"})," por packs."]}),F=="true"&&e.jsx("div",{children:e.jsx("div",{className:"text-sm font-semibold bg-[#C5B8D4] text-white rounded-3xl mt-4 py-4 px-[5%] whitespace-pre-line shadow-lg",children:l})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center bg-[#EFBEC1] text-white rounded-3xl mt-4 py-4 px-[5%] font-extrabold shadow-lg",children:[e.jsxs("div",{className:"text-xl text-start",children:["Elegiste ",d?d.name:e.jsxs(e.Fragment,{children:[x," ",x==1?"producto":"productos"]}),d&&e.jsx("span",{className:"block text-xs font-light",children:d.description})]}),e.jsxs("div",{className:"flex flex-row text-white items-center gap-4",children:[f!=p&&e.jsxs("p",{className:"font-light line-through",children:["Antes: S/",D(f)]}),e.jsxs("h2",{className:"text-2xl",children:["S/",D(p)]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mx-auto md:mx-[12.5%] mt-5 sm:mt-10",children:[e.jsxs("a",{href:`/test/result/${c.id}`,className:"bg-[#C5B8D4] text-white text-sm px-16 py-3 rounded mt-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsxs("button",{onClick:C,className:"bg-[#C5B8D4] text-white text-sm px-14 py-3 tracking-widest rounded mt-4 disabled:cursor-not-allowed leadin",disabled:x==0,children:["SIGUIENTE",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]})]})]})},je=new me,Ne=({formula:c,otherFormulas:m,goToPrevPage:N,publicKey:v,selectedPlan:g,bundles:$,planes:F,session:l,freeShipping:M,freeShippingMinimumAmount:w,freeShippingAmount:k,freeShippingZones:f})=>{var Q,G,H,U,K,J;const j=S.useRef(null);Culqi.publicKey=v??"",Culqi.options({paymentMethods:{tarjeta:!0,yape:!g,billetera:!g,bancaMovil:!g,agente:!g,cuotealo:!1},installments:!g,style:{logo:`${location.origin}/assets/img/icon-purple.svg`,bannerColor:"#A191B8"}});const x=q.Local.get("vua_cart"),[n,d]=S.useState(!1),[p,y]=S.useState(null),h=x.reduce((t,s)=>t+s.price*s.quantity,0),_=x.reduce((t,s)=>t+s.quantity,0),C=$.filter(t=>{switch(t.comparator){case"<":return _<t.items_quantity;case">":return _>t.items_quantity;default:return _==t.items_quantity}}).sort((t,s)=>s.percentage-t.percentage),r=(C==null?void 0:C[0])??null,i=h*((r==null?void 0:r.percentage)||0);let o=0;if(M=="true"&&!g)for(const t of f.split(","))h-i>=w?(E[t].delivery="Gratis",o=0):(E[t].delivery=`S/ ${D(k)}`,o=Number(k));const b=Object.keys(E).find(t=>E[t].name==(l==null?void 0:l.department)),[a,u]=S.useState({name:(l==null?void 0:l.name)||null,lastname:(l==null?void 0:l.lastname)||null,email:c.email,phone:(l==null?void 0:l.phone)||null,country:"Perú",department:b?b||"provincias":null,province:(l==null?void 0:l.province)||(l==null?void 0:l.department)||null,district:(l==null?void 0:l.district)||null,zip_code:(l==null?void 0:l.zip_code)||null,address:(l==null?void 0:l.address)||null,number:(l==null?void 0:l.address_number)||null,reference:(l==null?void 0:l.address_reference)||null,comment:null,billing_type:"boleta",billing_number:""}),P=F.find(t=>t.id==g),A=(h-i)*((P==null?void 0:P.percentage)||0),O=(h-i-A)*((p==null?void 0:p.amount)||0)/100,X=()=>{let t="Lima",s="Lima",B=null;return Array.isArray(E[a.department].items)?(t=E[a.department].name,s=a.province,B=null):(t=a.province,s=null,B=a.district),{...a,department_code:a.department,department:t,province:s,district:B}},ee=async t=>{if(t.preventDefault(),n)return;d(!0);let s=null;if(h>6){const B=await I.order({...X(),order_number:Culqi.order_number,user_formula_id:c.id,renewal_id:g,coupon:(p==null?void 0:p.name)??null},x);B&&(s=B.data.id,Culqi.order_number=B.data.order_number)}d(!1),Culqi.settings({title:`${Y.APP_NAME} ${g?"(Suscripción)":""}`.trim(),currency:"PEN",amount:Math.round(Math.ceil((h-i-A-O+o)*100)/10)*10,order:s}),Culqi.open()};window.culqi=async()=>{if(Culqi.token)await I.token({order:Culqi.order_number,token:Culqi.token})&&(location.href="/thanks");else if(Culqi.order){te();const t=Culqi.order_number.replace(`#${Y.APP_CORRELATIVE}-`,"");fetch(`/api/sales/notify/${t}`)}};const te=()=>{setInterval(()=>{Culqi.isOpen||(location.href="/thanks")},500)},V=t=>{t.preventDefault();const s=(j.current.value||"").trim().toUpperCase();s&&je.save({coupon:s,amount:h,email:c.email}).then(B=>{y(B?B.data:null)})},ae=t=>{t.key=="Enter"&&V(t)};return e.jsx(e.Fragment,{children:e.jsx("section",{className:"px-[5%] md:px-[7.5%] lg:px-[10%] pb-[5%] mt-[7.5%] md:mt-[5%] lg:mt-[2.5%] text-[#404040]",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex justify-center space-x-8 text-sm text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"SSL Pago Seguro"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"24/7 Atención al cliente"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Pago online"})]})]}),e.jsx("form",{className:"w-full rounded-lg bg-white p-8 shadow-lg",onSubmit:ee,disabled:n,children:e.jsxs("div",{className:"grid gap-8 md:grid-cols-2 lg:grid-cols-5 relative",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("button",{onClick:()=>N(m.length>0?2:1),className:"bg-[#C5B8D4] text-white text-sm px-4 py-2 rounded mb-4",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"VOLVER"]}),e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Información del cliente"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"email",children:["Dirección de correo electrónico ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"email",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.email,placeholder:"Dirección de correo electrónico",onChange:t=>u(s=>({...s,email:t.target.value})),required:!0,disabled:!0})]}),e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Detalles de facturación"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"firstName",children:["Nombre ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"firstName",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.name,onChange:t=>u(s=>({...s,name:t.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"lastName",children:["Apellidos ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"lastName",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.lastname,onChange:t=>u(s=>({...s,lastname:t.target.value})),required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"country",children:["País / Región ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"country",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.country,disabled:!0,required:!0})]}),e.jsx("div",{className:"mt-4 grid gap-4 md:grid-cols-5",children:e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"department",children:["Región / Provincia ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"department",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.department||"",onChange:t=>u(s=>({...s,department:t.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),Object.keys(E).map((t,s)=>e.jsx("option",{value:t,children:E[t].name},s))]})]})}),E[a.department]&&e.jsx("div",{className:"mt-4 grid gap-4 md:grid-cols-5",children:Array.isArray(E[a.department].items)?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"district",children:["Provincia ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"province",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.province,onChange:t=>u(s=>({...s,province:t.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Elige una opción"}),E[a.department].items.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:"Código postal"}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.zip_code,onChange:t=>u(s=>({...s,zip_code:t.target.value}))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:["Departamento ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.province??(l==null?void 0:l.department),onChange:t=>u(s=>({...s,province:t.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:["Distrito ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.district,onChange:t=>u(s=>({...s,district:t.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium  truncate text-ellipsis",htmlFor:"postalCode",title:"Código postal",children:"Código postal"}),e.jsx("input",{type:"text",id:"postalCode",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.zip_code,onChange:t=>u(s=>({...s,zip_code:t.target.value}))})]})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-5 lg:grid-cols-3",children:[e.jsxs("div",{className:"md:col-span-3 lg:col-span-2",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"address",children:["Dirección de la calle ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"address",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.address,placeholder:"Nombre de la calle y número de la calle",onChange:t=>u(s=>({...s,address:t.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"number",children:["Número ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"number",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.number,placeholder:"Nombre de la calle y número de la calle",onChange:t=>u(s=>({...s,number:t.target.value})),required:!0})]})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"apartment",children:"Apartamento, habitación, piso, etc. (opcional)"}),e.jsx("input",{type:"text",id:"apartment",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.reference,onChange:t=>u(s=>({...s,reference:t.target.value}))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"phone",children:["Teléfono/Celular ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex border rounded-md border-gray-300",children:[e.jsx("span",{className:"py-2 px-3 border-e",children:"+51"}),e.jsx("input",{type:"tel",id:"phone",className:"w-full p-2 text-sm outline-none",value:a.phone,onChange:t=>u(s=>({...s,phone:t.target.value})),placeholder:"900000000",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium ",htmlFor:"orderNotes",children:"Notas del pedido (opcional)"}),e.jsx("textarea",{id:"orderNotes",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",rows:3,placeholder:"Notas sobre tu pedido, por ejemplo, notas especiales para la entrega.",value:a.comment||"",onChange:t=>u(s=>({...s,comment:t.target.value})),style:{minHeight:81,fieldSizing:"content"}})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"mb-4 text-xl font-semibold",children:"Pago"}),e.jsxs("div",{className:"rounded-md border border-gray-300",children:[e.jsxs("div",{className:"p-4 py-3 flex justify-between",children:[e.jsx("img",{className:"h-4",src:"/assets/img/checkout/culqi-logo.svg",alt:"Culqi"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{className:"h-4",src:"/assets/img/checkout/cards.svg",alt:"Cards"}),e.jsx("img",{className:"h-4",src:"/assets/img/checkout/pagoefectivo.svg",alt:"Pago efectivo"}),e.jsx("img",{className:"h-4",src:"/assets/img/checkout/yape.svg",alt:"Yape"})]})]}),e.jsxs("p",{className:"text-xs bg-[#f9f9f9] p-4 px-6 rounded-b",children:["Acepta pagos con ",e.jsx("b",{children:"tarjetas de débito y crédito, Yape, Cuotealo BCP y PagoEfectivo"}),"(billeteras móviles, agentes y bodegas)."]})]})]}),e.jsx("div",{className:"mt-6 text-xs",children:e.jsxs("p",{className:"text-justify",children:["Sus datos personales se utilizarán para procesar su pedido, respaldar su experiencia en este sitio web y para otros fines descritos en nuestra "," ",e.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"política de privacidad"}),"."]})})]}),e.jsxs("div",{className:"lg:col-span-2 relative",children:[e.jsxs("div",{className:"block mb-6",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tu pedido"}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 flex justify-between border-b pb-2 font-bold",children:[e.jsx("span",{className:"",children:"Producto"}),e.jsx("span",{className:"",children:"Subtotal"})]}),e.jsx("div",{className:"mb-2",children:x.map((t,s)=>{var B;return e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 aspect-[3/4] relative",children:e.jsx("img",{className:"h-10 aspect-[3/4] object-cover object-center rounded-md border",src:`/api/colors/media/${(B=t.colors[0])==null?void 0:B.image}`,alt:t.name,onError:L=>L.target.src=`/api/items/media/${t.image}`})}),e.jsxs("div",{children:[e.jsx("p",{children:t.name}),e.jsxs("small",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"w-6 inline-block text-nowrap",children:["× ",t.quantity]}),e.jsx("div",{className:"inline-flex flex-wrap gap-0.5",children:t.colors.map((L,se)=>e.jsx("i",{className:"mdi mdi-circle",style:{color:(L==null?void 0:L.hex)??"#000",WebkitTextStroke:"1px #808080"}},se))})]})]})]}),e.jsxs("span",{className:"",children:["S/ ",D(t.price*t.quantity)]})]},s)})}),e.jsxs("div",{className:"mb-2 mt-4 flex justify-between border-b pb-2 text-sm font-bold",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["S/ ",D(Math.round(h*10)/10)]})]}),r&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Descuento x paquete",e.jsxs("small",{className:"block text-xs font-light",children:["Elegiste ",r.name," (-",Math.round(r.percentage*1e4)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",D(Math.round(i*10)/10)]})]}),P&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Subscripción",e.jsxs("small",{className:"block text-xs font-light",children:[P.name," (-",Math.round(P.percentage*1e4)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",D(Math.round(A*10)/10)]})]}),p&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado ",e.jsx(z,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>y(null)})}),e.jsxs("small",{className:"block text-xs font-light",children:[p.name," ",e.jsx(z,{content:p.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," (-",Math.round(p.amount*100)/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",D(O)]})]}),a.department&&e.jsxs("div",{className:"mb-4 flex justify-between text-sm border-b pb-2",children:[e.jsx("span",{className:"font-bold",children:"Envío"}),e.jsx("span",{children:typeof((G=(Q=E)==null?void 0:Q[a.department])==null?void 0:G.delivery)=="number"?`S/ ${D((U=(H=E)==null?void 0:H[a.department])==null?void 0:U.delivery)}`:(J=(K=E)==null?void 0:K[a.department])==null?void 0:J.delivery})]}),e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",D(Math.round((h-i-A-O+o)*10)/10)]})]})]}),!p&&e.jsxs("div",{className:"mt-6 flex",children:[e.jsx("input",{ref:j,type:"text",placeholder:"Código de cupón",className:"w-full rounded-l-md border border-gray-300 p-2 px-4 text-sm outline-none uppercase focus:border-[#C5B8D4]",value:p==null?void 0:p.name,onKeyDown:ae,disabled:n}),e.jsx("button",{className:"rounded-r-md bg-[#C5B8D4] px-4 py-2 text-sm text-white",type:"button",onClick:V,disabled:n,children:"Aplicar"})]})]}),e.jsxs("div",{className:"block sticky top-4",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Datos de facturacion"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"mb-1 block text-sm font-medium ",htmlFor:"billing_type",children:["Tipo de comprobante ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"billing_type",value:"boleta",id:"billing_type_boleta",defaultChecked:a.billing_type=="boleta",className:"hidden peer",onChange:t=>u(s=>({...s,billing_type:t.target.value})),checked:a.billing_type=="boleta",required:!0}),e.jsxs("label",{htmlFor:"billing_type_boleta",className:"flex gap-1.5 items-center justify-center px-2 py-1 border rounded-md cursor-pointer peer-checked:bg-[#C5B8D4] peer-checked:text-white transition-colors",children:[e.jsx("i",{className:"mdi mdi-account text-lg"}),e.jsx("span",{children:"Boleta"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"billing_type",value:"factura",id:"billing_type_factura",defaultChecked:a.billing_type=="factura",className:"hidden peer",onChange:t=>u(s=>({...s,billing_type:t.target.value})),checked:a.billing_type=="factura",required:!0}),e.jsxs("label",{htmlFor:"billing_type_factura",className:"flex gap-1.5 items-center justify-center px-2 py-1 border rounded-md cursor-pointer peer-checked:bg-[#C5B8D4] peer-checked:text-white transition-colors",children:[e.jsx("i",{className:"mdi mdi-office-building text-lg"}),e.jsx("span",{children:"Factura"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-1 block text-sm font-medium ",htmlFor:"billing_number",children:["Documento ",e.jsx("b",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"billing_number",className:"w-full rounded-md border border-gray-300 p-2 text-sm outline-none",value:a.billing_number,maxLength:a.billing_type=="boleta"?8:11,minLength:a.billing_type=="boleta"?8:11,required:!0,onChange:t=>u(s=>({...s,billing_number:t.target.value}))})]}),e.jsxs("button",{type:"submit",className:"mt-6 w-full rounded-md bg-[#C5B8D4] py-3 text-white disabled:cursor-not-allowed",disabled:n,children:[e.jsx("i",{className:"mdi mdi-lock me-1"}),"Pagar Ahora",e.jsxs("small",{className:"ms-1",children:["(S/ ",D(h-i-A-O),")"]})]})]})]})]})})]})})})},ye=({user_formula:c,other_formulas:m,items:N,defaultColors:v,publicKey:g,session:$,bundles:F,planes:l,free_shipping:M,free_shipping_minimum_amount:w,free_shipping_amount:k,free_shipping_zones:f,free_shipping_banner:j})=>{const[x,n]=S.useState(0),[d,p]=S.useState(null),[y,h]=S.useState(m.sort((o,b)=>o.created_at<b.created_at?1:-1)),_=(o=1)=>{x<r.length-1&&n(x+o)},C=(o=1)=>{x>0&&n(x-o)},r=[{name:"Select Product",component:e.jsx(fe,{formula:c,otherFormulas:y,setOtherFormulas:h,items:N,goToNextPage:_,bundles:F,freeShipping:M,freeShippingBannerText:j})},{name:"Select Color",component:e.jsx(he,{formula:c,otherFormulas:y,items:N,defaultColors:v,goToNextPage:_,goToPrevPage:C,setSelectedPlan:p})},{name:"Select Plan",component:e.jsx(be,{formula:c,otherFormulas:y,goToNextPage:_,goToPrevPage:C,setSelectedPlan:p,session:$,bundles:F,planes:l})},{name:"Checkout",component:e.jsx(Ne,{formula:c,otherFormulas:y,goToPrevPage:C,publicKey:g,selectedPlan:d,goToNextPage:_,bundles:F,planes:l,session:$,freeShipping:M,freeShippingMinimumAmount:w,freeShippingAmount:k,freeShippingZones:f})}],i=r[x].component;return S.useEffect(()=>{q.Local.set("vua_formula",c)},[null]),i};ce((c,m)=>{ne(c).render(e.jsx(ie,{...m,children:e.jsx(ye,{...m})}))});
